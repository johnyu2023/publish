import{_ as i,c as a,o as n,a1 as l}from"./chunks/framework.6sy4tsQT.js";const g=JSON.parse('{"title":"Python 的虚拟环境","description":"Python 虚拟环境的使用思考","frontmatter":{"title":"Python 的虚拟环境","description":"Python 虚拟环境的使用思考","date":"2025-10-23T00:00:00.000Z","tags":["Python，虚拟环境"]},"headers":[],"relativePath":"fullstack/python-venv.md","filePath":"fullstack/python-venv.md"}'),t={name:"fullstack/python-venv.md"};function h(e,s,p,k,r,d){return n(),a("div",null,[...s[0]||(s[0]=[l(`<h2 id="python-虚拟环境的最佳实践-传统" tabindex="-1">Python 虚拟环境的最佳实践-传统 <a class="header-anchor" href="#python-虚拟环境的最佳实践-传统" aria-label="Permalink to &quot;Python 虚拟环境的最佳实践-传统&quot;">​</a></h2><blockquote><p><strong>强烈建议在虚拟环境中安装！</strong> 这是 Python 开发的最佳实践</p></blockquote><h3 id="为什么推荐使用虚拟环境" tabindex="-1">为什么推荐使用虚拟环境？ <a class="header-anchor" href="#为什么推荐使用虚拟环境" aria-label="Permalink to &quot;为什么推荐使用虚拟环境？&quot;">​</a></h3><h4 id="_1-依赖隔离" tabindex="-1">1. <strong>依赖隔离</strong> <a class="header-anchor" href="#_1-依赖隔离" aria-label="Permalink to &quot;1. **依赖隔离**&quot;">​</a></h4><ul><li>每个项目可以有自己独立的包版本</li><li>避免不同项目之间的包版本冲突</li><li>例如：项目A需要 Django 3.2，项目B需要 Django 4.1</li></ul><h4 id="_2-避免污染系统环境" tabindex="-1">2. <strong>避免污染系统环境</strong> <a class="header-anchor" href="#_2-避免污染系统环境" aria-label="Permalink to &quot;2. **避免污染系统环境**&quot;">​</a></h4><ul><li>不会修改系统级别的 Python 包</li><li>防止意外破坏系统工具（很多 Linux 系统工具依赖特定版本的 Python 包）</li></ul><h4 id="_3-便于项目管理" tabindex="-1">3. <strong>便于项目管理</strong> <a class="header-anchor" href="#_3-便于项目管理" aria-label="Permalink to &quot;3. **便于项目管理**&quot;">​</a></h4><ul><li>可以清晰知道每个项目依赖哪些包</li><li>方便生成 <code>requirements.txt</code></li><li>便于团队协作和部署</li></ul><h3 id="如何创建和使用虚拟环境" tabindex="-1">如何创建和使用虚拟环境？ <a class="header-anchor" href="#如何创建和使用虚拟环境" aria-label="Permalink to &quot;如何创建和使用虚拟环境？&quot;">​</a></h3><h4 id="使用内置的-venv-推荐" tabindex="-1">使用内置的 <code>venv</code>（推荐） <a class="header-anchor" href="#使用内置的-venv-推荐" aria-label="Permalink to &quot;使用内置的 \`venv\`（推荐）&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 创建虚拟环境</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> venv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> myproject_env</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 激活虚拟环境</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Windows:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">myproject_env\\Scripts\\activate</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># macOS/Linux:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> myproject_env/bin/activate</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 现在安装包（会安装到虚拟环境中）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 你的包名</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 退出虚拟环境</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">deactivate</span></span></code></pre></div><h4 id="使用-conda-如果你用-anaconda-miniconda" tabindex="-1">使用 <code>conda</code>（如果你用 Anaconda/Miniconda） <a class="header-anchor" href="#使用-conda-如果你用-anaconda-miniconda" aria-label="Permalink to &quot;使用 \`conda\`（如果你用 Anaconda/Miniconda）&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 创建环境</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">conda</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> create</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> myproject</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> python=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3.9</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 激活环境</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">conda</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> activate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> myproject</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 安装包</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 你的包名</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 退出环境</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">conda</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> deactivate</span></span></code></pre></div><h3 id="什么时候可以不用虚拟环境" tabindex="-1">什么时候可以不用虚拟环境？ <a class="header-anchor" href="#什么时候可以不用虚拟环境" aria-label="Permalink to &quot;什么时候可以不用虚拟环境？&quot;">​</a></h3><ul><li>临时测试某个包的功能</li><li>安装全局工具（如 <code>black</code>, <code>flake8</code> 等代码格式化/检查工具）</li><li>确定不会与其他项目产生冲突的简单脚本</li></ul><h2 id="python-虚拟环境本质是一个目录" tabindex="-1">Python 虚拟环境本质是一个目录 <a class="header-anchor" href="#python-虚拟环境本质是一个目录" aria-label="Permalink to &quot;Python 虚拟环境本质是一个目录&quot;">​</a></h2><h3 id="虚拟环境的位置" tabindex="-1">虚拟环境的位置 <a class="header-anchor" href="#虚拟环境的位置" aria-label="Permalink to &quot;虚拟环境的位置&quot;">​</a></h3><p><strong><code>stock_env</code> 是在当前目录下创建的一个文件夹</strong>，不是全局的。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 如果你在 /home/user/myproject 目录下执行</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> venv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stock_env</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 那么会创建</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/home/user/myproject/stock_env/</span></span></code></pre></div><p>这个文件夹包含：</p><ul><li>Python 解释器的副本（或符号链接）</li><li>独立的 <code>site-packages</code> 目录（存放安装的包）</li><li>pip、activate 脚本等工具</li></ul><h3 id="不同项目的虚拟环境可以同名吗" tabindex="-1">不同项目的虚拟环境可以同名吗？ <a class="header-anchor" href="#不同项目的虚拟环境可以同名吗" aria-label="Permalink to &quot;不同项目的虚拟环境可以同名吗？&quot;">​</a></h3><p><strong>完全可以！</strong> 因为它们是<strong>不同路径下的不同文件夹</strong>。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 项目1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/home/user/project_a/stock_env/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 项目2  </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/home/user/project_b/stock_env/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 这是两个完全独立的虚拟环境，互不影响</span></span></code></pre></div><h3 id="实际使用建议" tabindex="-1">实际使用建议 <a class="header-anchor" href="#实际使用建议" aria-label="Permalink to &quot;实际使用建议&quot;">​</a></h3><p>虽然可以同名，但<strong>建议使用有意义的名称</strong>：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 更好的命名方式</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> venv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> myproject_env</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          # 通用</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> venv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .venv</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                  # 隐藏文件夹，很多开发者喜欢</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> venv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> venv</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                   # 简短通用</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 或者直接用项目名</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> venv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> trading-bot</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> venv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> data-analysis</span></span></code></pre></div><h3 id="虚拟环境的管理技巧" tabindex="-1">虚拟环境的管理技巧 <a class="header-anchor" href="#虚拟环境的管理技巧" aria-label="Permalink to &quot;虚拟环境的管理技巧&quot;">​</a></h3><h4 id="_1-通常将虚拟环境放在项目根目录" tabindex="-1">1. <strong>通常将虚拟环境放在项目根目录</strong> <a class="header-anchor" href="#_1-通常将虚拟环境放在项目根目录" aria-label="Permalink to &quot;1. **通常将虚拟环境放在项目根目录**&quot;">​</a></h4><div class="language-plaintext vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">plaintext</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>my_project/</span></span>
<span class="line"><span>├── stock_env/           # 虚拟环境</span></span>
<span class="line"><span>├── src/</span></span>
<span class="line"><span>├── requirements.txt</span></span>
<span class="line"><span>└── README.md</span></span></code></pre></div><h4 id="_2-记得添加到-gitignore" tabindex="-1">2. <strong>记得添加到 .gitignore</strong> <a class="header-anchor" href="#_2-记得添加到-gitignore" aria-label="Permalink to &quot;2. **记得添加到 .gitignore**&quot;">​</a></h4><div class="language-plaintext vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">plaintext</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># .gitignore</span></span>
<span class="line"><span>stock_env/</span></span>
<span class="line"><span>venv/</span></span>
<span class="line"><span>.env/</span></span>
<span class="line"><span>__pycache__/</span></span></code></pre></div><h4 id="_3-激活时注意路径" tabindex="-1">3. <strong>激活时注意路径</strong> <a class="header-anchor" href="#_3-激活时注意路径" aria-label="Permalink to &quot;3. **激活时注意路径**&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 必须在虚拟环境所在目录或使用完整路径</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./stock_env/bin/activate</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Linux/macOS</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 或</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /full/path/to/stock_env/bin/activate</span></span></code></pre></div><h2 id="虚拟环境激活后无需手动关闭" tabindex="-1">虚拟环境激活后无需手动关闭 <a class="header-anchor" href="#虚拟环境激活后无需手动关闭" aria-label="Permalink to &quot;虚拟环境激活后无需手动关闭&quot;">​</a></h2><blockquote><p><strong>虚拟环境激活后不需要手动终止</strong>。<br> 它只是一个“当前终端用哪个 Python”的开关，不是服务，不占资源。</p></blockquote><p>在 PowerShell（或任何终端）中 <strong>激活虚拟环境</strong>（例如通过 <code>.\\venv\\Scripts\\Activate.ps1</code>）<strong>只是一个临时的 shell 状态变更</strong>，它只影响当前终端会话，不会启动后台进程或服务。</p><hr><h3 id="✅-详细说明" tabindex="-1">✅ 详细说明 <a class="header-anchor" href="#✅-详细说明" aria-label="Permalink to &quot;✅ 详细说明&quot;">​</a></h3><h4 id="_1-激活虚拟环境的本质" tabindex="-1">1. <strong>激活虚拟环境的本质</strong> <a class="header-anchor" href="#_1-激活虚拟环境的本质" aria-label="Permalink to &quot;1. **激活虚拟环境的本质**&quot;">​</a></h4><p>运行：</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.\\venv\\Scripts\\Activate.ps1</span></span></code></pre></div><p>只是做了两件事：</p><ul><li>修改当前终端的 <code>PATH</code> 环境变量，把 <code>venv\\Scripts</code> 放到最前面；</li><li>修改命令行提示符（如加上 <code>(venv)</code> 前缀）。</li></ul><blockquote><p>它 <strong>没有启动任何守护进程</strong>，也没有“运行中”的服务需要关闭。</p></blockquote><h4 id="_2-如何-退出-虚拟环境" tabindex="-1">2. <strong>如何“退出”虚拟环境？</strong> <a class="header-anchor" href="#_2-如何-退出-虚拟环境" aria-label="Permalink to &quot;2. **如何“退出”虚拟环境？**&quot;">​</a></h4><ul><li><p><strong>方法一（推荐）</strong>：在当前终端运行：</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">deactivate</span></span></code></pre></div><p>这会恢复原来的 <code>PATH</code> 和提示符。</p></li><li><p><strong>方法二</strong>：直接 <strong>关闭终端窗口</strong>。<br> 虚拟环境的状态只存在于该终端会话中，窗口一关，一切自动还原。</p></li></ul><h4 id="_3-如果你是在脚本中激活环境-如你的-register-jupyter-kernel-ps1" tabindex="-1">3. <strong>如果你是在脚本中激活环境（如你的 <code>register_jupyter_kernel.ps1</code>）</strong> <a class="header-anchor" href="#_3-如果你是在脚本中激活环境-如你的-register-jupyter-kernel-ps1" aria-label="Permalink to &quot;3. **如果你是在脚本中激活环境（如你的 \`register_jupyter_kernel.ps1\`）**&quot;">​</a></h4><ul><li>脚本结束后，<strong>激活状态不会保留到父终端</strong>（因为 PowerShell 脚本默认在子作用域运行）。</li><li>所以你运行完脚本后，看到的终端<strong>仍然是未激活状态</strong>，这是正常行为，无需处理。</li></ul><blockquote><p>✅ 换句话说：<strong>你完全不需要“手动终止”虚拟环境</strong>，除非你想在同一个终端里切换回全局 Python。</p></blockquote><hr><h3 id="🚫-常见误解澄清" tabindex="-1">🚫 常见误解澄清 <a class="header-anchor" href="#🚫-常见误解澄清" aria-label="Permalink to &quot;🚫 常见误解澄清&quot;">​</a></h3><table tabindex="0"><thead><tr><th>误解</th><th>事实</th></tr></thead><tbody><tr><td>“激活环境后要手动关闭，否则会占用资源”</td><td>❌ 虚拟环境只是路径切换，不消耗额外资源</td></tr><tr><td>“不 deactivate 会导致系统变慢”</td><td>❌ 完全不会，只影响当前终端的命令解析</td></tr><tr><td>“Jupyter 运行时需要保持终端激活”</td><td>❌ Jupyter 内核一旦启动，就独立运行，与是否激活无关</td></tr></tbody></table><hr><h3 id="✅-最佳实践建议" tabindex="-1">✅ 最佳实践建议 <a class="header-anchor" href="#✅-最佳实践建议" aria-label="Permalink to &quot;✅ 最佳实践建议&quot;">​</a></h3><ul><li>如果你在<strong>交互式终端</strong>中工作，用完虚拟环境后可以运行 <code>deactivate</code> 保持清晰；</li><li>如果你在<strong>脚本中激活环境</strong>（如自动注册内核），<strong>无需也不应该</strong>在脚本末尾调用 <code>deactivate</code> —— 因为脚本结束后作用域自动消失；</li><li>如果你只是<strong>临时运行一个命令</strong>（如 <code>python train.py</code>），激活后运行完直接关终端即可。</li></ul><h2 id="虚拟环境的空间占用问题" tabindex="-1">虚拟环境的空间占用问题 <a class="header-anchor" href="#虚拟环境的空间占用问题" aria-label="Permalink to &quot;虚拟环境的空间占用问题&quot;">​</a></h2><p><strong>实际情况：</strong></p><ul><li>虚拟环境确实会在每个项目目录下创建独立的依赖库</li><li>但现代 Python 虚拟环境（如 venv、conda）会使用<strong>符号链接</strong>或<strong>硬链接</strong>来减少重复文件</li><li>相同版本的包在不同虚拟环境中通常不会完全复制，而是共享底层文件</li></ul><p><strong>空间占用估算：</strong></p><ul><li>一个基础的虚拟环境大约 10-20MB</li><li>如果项目依赖大型库（如 numpy、pandas、tensorflow），每个环境可能增加 100MB-1GB+</li><li>但如果你有 10 个项目都用相同的依赖，实际占用可能只有 1-2GB，而不是 10GB</li></ul><h2 id="硬盘空间分配实用解决方案" tabindex="-1">硬盘空间分配实用解决方案 <a class="header-anchor" href="#硬盘空间分配实用解决方案" aria-label="Permalink to &quot;硬盘空间分配实用解决方案&quot;">​</a></h2><ol><li><strong>创建专门的开发目录</strong>（如 D:\\PythonProjects）</li><li><strong>使用虚拟环境</strong>，但集中管理在 D:\\venvs</li><li><strong>每个项目保持独立</strong>，避免依赖冲突</li><li><strong>定期清理</strong>不用的项目和环境</li></ol><h2 id="对c盘清理的建议" tabindex="-1">对C盘清理的建议 <a class="header-anchor" href="#对c盘清理的建议" aria-label="Permalink to &quot;对C盘清理的建议&quot;">​</a></h2><p>你<strong>不需要写 Python 程序</strong>，直接在 <strong>PowerShell 中用一条（或两行）命令</strong>就能安全清空 C 盘中的第三方 Python 依赖库。</p><hr><h3 id="✅-推荐方法-使用-powershell-一行命令卸载所有第三方包" tabindex="-1">✅ 推荐方法：使用 PowerShell 一行命令卸载所有第三方包 <a class="header-anchor" href="#✅-推荐方法-使用-powershell-一行命令卸载所有第三方包" aria-label="Permalink to &quot;✅ 推荐方法：使用 PowerShell 一行命令卸载所有第三方包&quot;">​</a></h3><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pip freeze </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ForEach-Object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { $pkg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> $_</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.Split(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;==&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ($pkg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-notin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> @</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;pip&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;setuptools&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;wheel&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;pkg-resources&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)) { pip uninstall </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y $pkg } }</span></span></code></pre></div><blockquote><p>💡 <strong>复制粘贴这一整行到 PowerShell 中运行即可。</strong></p></blockquote><hr><h3 id="🔍-这条命令做了什么" tabindex="-1">🔍 这条命令做了什么？ <a class="header-anchor" href="#🔍-这条命令做了什么" aria-label="Permalink to &quot;🔍 这条命令做了什么？&quot;">​</a></h3><ol><li><code>pip freeze</code>：列出所有已安装的包（格式如 <code>numpy==1.24.0</code>）</li><li><code>ForEach-Object</code>：遍历每一行</li><li><code>Split(&#39;==&#39;)[0]</code>：提取包名（如 <code>numpy</code>）</li><li>排除核心工具包：<code>pip</code>、<code>setuptools</code>、<code>wheel</code>、<code>pkg-resources</code></li><li>对其余所有包执行 <code>pip uninstall -y</code>（<code>-y</code> 表示自动确认）</li></ol><hr><h3 id="🛡️-安全建议-强烈推荐先做" tabindex="-1">🛡️ 安全建议（强烈推荐先做） <a class="header-anchor" href="#🛡️-安全建议-强烈推荐先做" aria-label="Permalink to &quot;🛡️ 安全建议（强烈推荐先做）&quot;">​</a></h3><h4 id="_1-先备份包列表-以防万一" tabindex="-1">1. <strong>先备份包列表（以防万一）</strong> <a class="header-anchor" href="#_1-先备份包列表-以防万一" aria-label="Permalink to &quot;1. **先备份包列表（以防万一）**&quot;">​</a></h4><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pip freeze </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> D:\\python_global_packages_backup.txt</span></span></code></pre></div><p>这样万一误删了某个你其实需要的全局工具（比如 <code>black</code>、<code>jupyter</code>），还能恢复。</p><h4 id="_2-先预览要删除哪些包" tabindex="-1">2. <strong>先预览要删除哪些包</strong> <a class="header-anchor" href="#_2-先预览要删除哪些包" aria-label="Permalink to &quot;2. **先预览要删除哪些包**&quot;">​</a></h4><p>运行这个命令看看会删什么：</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pip freeze </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ForEach-Object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { $pkg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> $_</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.Split(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;==&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ($pkg </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-notin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> @</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;pip&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;setuptools&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;wheel&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;pkg-resources&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)) { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Write-Host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Will uninstall: </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$pkg</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } }</span></span></code></pre></div><hr><h3 id="🧹-额外清理-可选" tabindex="-1">🧹 额外清理（可选） <a class="header-anchor" href="#🧹-额外清理-可选" aria-label="Permalink to &quot;🧹 额外清理（可选）&quot;">​</a></h3><p>清空 pip 缓存，进一步释放 C 盘空间：</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pip cache purge</span></span></code></pre></div><hr><h3 id="❌-不要做的事" tabindex="-1">❌ 不要做的事 <a class="header-anchor" href="#❌-不要做的事" aria-label="Permalink to &quot;❌ 不要做的事&quot;">​</a></h3><ul><li><strong>不要手动删除 <code>site-packages</code> 文件夹里的内容</strong> → 可能导致 pip 状态不一致</li><li><strong>不要卸载 <code>pip</code>、<code>setuptools</code>、<code>wheel</code></strong> → 虚拟环境创建会依赖它们</li></ul><hr><h3 id="✅-验证是否清理干净" tabindex="-1">✅ 验证是否清理干净 <a class="header-anchor" href="#✅-验证是否清理干净" aria-label="Permalink to &quot;✅ 验证是否清理干净&quot;">​</a></h3><p>清理后运行：</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pip list</span></span></code></pre></div><p>正常输出应该只有：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Package    Version</span></span>
<span class="line"><span>---------- -------</span></span>
<span class="line"><span>pip        23.x.x</span></span>
<span class="line"><span>setuptools 65.x.x</span></span>
<span class="line"><span>wheel      0.x.x</span></span></code></pre></div><p>如果有其他包，说明它们可能是通过 <code>--user</code> 安装的，你可以额外清理用户目录的包：</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 清理用户级安装的包（如果存在）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pip uninstall </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user (pip list </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Select-String</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Pattern </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;^[^P]&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ForEach-Object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$_</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -split</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39; &#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] })</span></span></code></pre></div><p>不过大多数情况下，第一条命令已经足够。</p><hr><h3 id="总结" tabindex="-1">总结 <a class="header-anchor" href="#总结" aria-label="Permalink to &quot;总结&quot;">​</a></h3><ul><li><strong>用 PowerShell 一行命令即可完成</strong></li><li><strong>无需写 Python 脚本</strong></li><li><strong>先备份，再执行，很安全</strong></li></ul><p>现在你就可以放心清理 C 盘的 Python 第三方库了！</p><h2 id="虚拟环境的懒人版" tabindex="-1">虚拟环境的懒人版 <a class="header-anchor" href="#虚拟环境的懒人版" aria-label="Permalink to &quot;虚拟环境的懒人版&quot;">​</a></h2><blockquote><p>我有很多个 python 的小项目，每个项目都在不同目录下，代码结构都比较简单。如果每个项目都遵循创建自己的虚拟环境，就会非常繁琐。 我希望不用虚拟环境，直接用公共的配置环境。但以后如果有新的复杂项目，再在其中使用虚拟环境。</p></blockquote><h3 id="✅-为什么可行" tabindex="-1">✅ 为什么可行？ <a class="header-anchor" href="#✅-为什么可行" aria-label="Permalink to &quot;✅ 为什么可行？&quot;">​</a></h3><ol><li><p><strong>小项目依赖简单、冲突少</strong><br> 如果你的小项目只用到一些通用、稳定的库（如 <code>requests</code>, <code>pandas</code>, <code>numpy</code> 等），且版本要求不苛刻，共用一个全局环境通常不会出问题。</p></li><li><p><strong>开发效率优先</strong><br> 对于快速验证想法、写小工具来说，省去创建/激活虚拟环境的步骤能显著提升效率——这符合你“成本效益高”的偏好。</p></li><li><p><strong>复杂项目仍可隔离</strong><br> 你计划在需要时（如大型项目、多版本依赖、团队协作）再启用虚拟环境，这是<strong>最佳实践的灵活应用</strong>，完全合理。</p></li></ol><hr><h3 id="⚠️-潜在风险与应对建议" tabindex="-1">⚠️ 潜在风险与应对建议 <a class="header-anchor" href="#⚠️-潜在风险与应对建议" aria-label="Permalink to &quot;⚠️ 潜在风险与应对建议&quot;">​</a></h3><table tabindex="0"><thead><tr><th>风险</th><th>说明</th><th>建议</th></tr></thead><tbody><tr><td><strong>依赖冲突</strong></td><td>某天两个小项目需要同一库的不同版本</td><td>记录每个项目的核心依赖（哪怕简单写个 <code>requirements.txt</code>），未来冲突时可快速重建虚拟环境</td></tr><tr><td><strong>环境“污染”</strong></td><td>安装太多无用包，难以管理</td><td>定期用 <code>pip list</code> 查看，或用 <code>pip-autoremove</code>（需安装）清理无依赖的包</td></tr><tr><td><strong>硬盘空间</strong></td><td>所有库装在一起，占用空间增长</td><td>Python 包通常不大（除非含二进制如 <code>torch</code>, <code>tensorflow</code>），但若真空间紧张：<br>• 用 <code>pip cache purge</code> 清理 pip 缓存<br>• 删除不用的包<br>• 必要时迁移到虚拟环境再卸载全局包</td></tr></tbody></table><hr><h3 id="💡-实用建议" tabindex="-1">💡 实用建议 <a class="header-anchor" href="#💡-实用建议" aria-label="Permalink to &quot;💡 实用建议&quot;">​</a></h3><ol><li><p><strong>保持全局环境“干净”</strong><br> 只安装<strong>高频通用库</strong>（如 <code>requests</code>, <code>click</code>, <code>pyyaml</code>），避免为一次性项目装重型库。</p></li><li><p><strong>记录依赖</strong><br> 即使不用虚拟环境，也建议每个项目根目录放一个 <code>requirements.txt</code>（哪怕只有几行），例如：</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>requests&gt;=2.25.0</span></span>
<span class="line"><span>pandas</span></span></code></pre></div><p>这样未来迁移或重装系统时非常方便。</p></li><li><p><strong>监控空间使用</strong><br> Python 第三方库一般安装在：</p><ul><li>Linux/macOS: <code>~/.local/lib/python3.x/site-packages/</code> 或系统路径</li><li>Windows: <code>%LOCALAPPDATA%\\Programs\\Python\\Python3x\\Lib\\site-packages\\</code></li></ul><p>你可以定期检查该目录大小。普通库几十 MB，即使上百个也通常不到 10GB。</p></li><li><p><strong>未来迁移容易</strong><br> 如果某小项目变复杂了，你可以：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> venv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> venv</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> venv/bin/activate</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Linux/macOS</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> requirements.txt</span></span></code></pre></div><p>然后从全局环境中卸载相关包（如果确定其他项目不用）。</p></li></ol><hr><h3 id="✅-总结" tabindex="-1">✅ 总结 <a class="header-anchor" href="#✅-总结" aria-label="Permalink to &quot;✅ 总结&quot;">​</a></h3><ul><li><strong>现在这样做没问题</strong>：小项目共用全局环境 + 复杂项目用虚拟环境，是合理且高效的做法。</li><li><strong>空间问题不必过度担心</strong>：除非你大量安装 AI/科学计算类重型库，否则普通库占用有限。</li><li><strong>保持简单记录</strong>：用 <code>requirements.txt</code> 留痕，未来可进可退。</li></ul><h2 id="_2025-10-25-解决方案" tabindex="-1">2025-10-25 解决方案 <a class="header-anchor" href="#_2025-10-25-解决方案" aria-label="Permalink to &quot;2025-10-25 解决方案&quot;">​</a></h2><p>目标是在有限硬盘空间下高效管理多个依赖大型库（如 LangChain、PyTorch 等）的 Python 项目。结合目录结构和需求，<strong>推荐采用“共享大库 + 轻量项目虚拟环境”方案</strong>，具体操作如下：</p><hr><h3 id="最终目标结构" tabindex="-1">最终目标结构 <a class="header-anchor" href="#最终目标结构" aria-label="Permalink to &quot;最终目标结构&quot;">​</a></h3><div class="language-plaintext vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">plaintext</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>D:\\2024-code\\lesson2025\\</span></span>
<span class="line"><span>├── shared-libs\\                 ← 共享的大型依赖库（如 langchain, torch, openai）</span></span>
<span class="line"><span>├── 14-16-LangChain-01\\</span></span>
<span class="line"><span>│   └── .venv\\                   ← 仅包含小依赖的轻量虚拟环境</span></span>
<span class="line"><span>└── 17-Case-SQL-LangChain\\</span></span>
<span class="line"><span>    └── .venv\\                   ← 仅包含小依赖的轻量虚拟环境</span></span></code></pre></div><h3 id="实施步骤-windows-环境" tabindex="-1">实施步骤（Windows 环境） <a class="header-anchor" href="#实施步骤-windows-环境" aria-label="Permalink to &quot;实施步骤（Windows 环境）&quot;">​</a></h3><h4 id="第-1-步-创建共享库环境" tabindex="-1">第 1 步：创建共享库环境 <a class="header-anchor" href="#第-1-步-创建共享库环境" aria-label="Permalink to &quot;第 1 步：创建共享库环境&quot;">​</a></h4><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 进入你的项目根目录</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cd D:\\</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2024</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">code\\lesson2025</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 创建共享库目录（作为虚拟环境）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">python </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">m venv shared</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">libs</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 激活共享环境并安装大型依赖</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">shared</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">libs\\Scripts\\activate</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pip install jupyterlab langchain dashscope  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 根据实际需求添加</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">deactivate</span></span></code></pre></div><blockquote><p>💡 提示：用 <code>pip freeze &gt; shared-libs/requirements.txt</code> 保存共享依赖清单 (每次安装新的依赖库的时候重新执行此命令)</p></blockquote><h4 id="第-2-步-为每个项目创建轻量虚拟环境" tabindex="-1">第 2 步：为每个项目创建轻量虚拟环境 <a class="header-anchor" href="#第-2-步-为每个项目创建轻量虚拟环境" aria-label="Permalink to &quot;第 2 步：为每个项目创建轻量虚拟环境&quot;">​</a></h4><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 处理第一个项目</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cd </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1416</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LangChain</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">01</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 进入项目目录 1416-LangChain-01</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">python </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">m venv .venv </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 创建虚拟环境</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.venv\\Scripts\\activate  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 激活虚拟环境</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">python </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">m pip install </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">upgrade pip </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 推荐这么做，升级一下</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">python </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">m pip install ipykernel  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 只安装项目特有小依赖（不要装 langchain 等大库！）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">python </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">m ipykernel install </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1416</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LangChain</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">01</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> --</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">display</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;1416-LangChain-01&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># name 是文件系统路径，电脑上全局唯一；display-name 是 Jupyter 中显示的名称，可自定义</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 执行命令后，ipykernel 会：</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1. 在当前用户的 Jupyter 全局配置目录（即 %APPDATA%\\jupyter\\kernels\\）下，</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 2. 创建一个以 --name 命名的子目录（如 1416-langchain-01），</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 3. 并在里面生成 kernel.json 文件。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 无论 JupyterLab 装在系统、共享库、还是某个虚拟环境，所有通过 --user 注册的 kernel 都会放在这里。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">deactivate </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 退出虚拟环境</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 处理第二个项目，做法完全类似</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cd ..\\</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">17</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SQL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LangChain</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">python </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">m venv .venv</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.venv\\Scripts\\activate</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">python </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">m pip install </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">upgrade pip </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 推荐这么做，升级一下</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">python </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">m pip install ipykernel  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 只安装项目特有小依赖</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">python </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">m ipykernel install </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">17</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SQL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LangChain </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">display</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;17-Case-SQL-LangChain&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">deactivate</span></span></code></pre></div><h4 id="第-3-步-让项目环境能访问共享库" tabindex="-1">第 3 步：让项目环境能访问共享库 <a class="header-anchor" href="#第-3-步-让项目环境能访问共享库" aria-label="Permalink to &quot;第 3 步：让项目环境能访问共享库&quot;">​</a></h4><p>在每个项目的虚拟环境中创建 <code>.pth</code> 文件（自动继承共享库路径）：</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 为第一个项目添加共享路径</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">echo D:\\</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2024</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">code\\lesson2025\\shared</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">libs\\Lib\\site</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">packages </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1416</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LangChain</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">\\.venv\\Lib\\site</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">packages\\shared.pth</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 通过这一句命令，将共享库路径添加到项目的 .pth 文件中，即完成创建+填充内容</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 注意，内容里的路径必须是绝对路径</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 实际有可能会碰到 【UnicodeDecodeError: &#39;gbk&#39; codec can&#39;t decode byte 0xff in position 0: illegal multibyte sequence】</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 这是由于【某个 .pth 文件包含非法字节（很可能是 BOM 头 0xff 0xfe 或 0xff），导致 Python 在启动时无法正确解码它。】</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 解决办法：其实是windows写入该文件时错误。本质是不要用记事本打开 .pth 文件，而是用专业文本编辑器（如 VS Code）打开</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 偷懒的办法：将其他格式完好的 shared.pth 拷贝到目标目录即可</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 为第二个项目添加共享路径</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">echo D:\\</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2024</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">code\\lesson2025\\shared</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">libs\\Lib\\site</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">packages </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 17</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SQL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LangChain\\.venv\\Lib\\site</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">packages\\shared.pth</span></span></code></pre></div><blockquote><p>✅ 验证：激活任一项目环境后，执行 <code>python -c &quot;import langchain; print(langchain.__file__)&quot;</code> 应显示共享库路径</p></blockquote><h4 id="第-4-步-启动-jupyterlab-从共享环境" tabindex="-1">第 4 步：启动 JupyterLab（从共享环境） <a class="header-anchor" href="#第-4-步-启动-jupyterlab-从共享环境" aria-label="Permalink to &quot;第 4 步：启动 JupyterLab（从共享环境）&quot;">​</a></h4><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cd D:\\</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2024</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">code\\lesson2025</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">shared</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">libs\\Scripts\\activate</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">jupyter lab</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># jupyterlab 是一个 Jupyter 的前端插件，真正的命令行入口是 jupyter</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># jupyter lab        # ✅ 标准用法</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># jupyter notebook   # ✅ 也是 jupyter 的子命令</span></span></code></pre></div><p>打开浏览器后，新建 Notebook 时，你就能在 “Kernel” → “Change kernel” 中看到： 1416-LangChain-01 17-Case-SQL-LangChain 每个 kernel 会使用对应项目的 .venv 中的依赖（包括共享大库 + 项目小依赖）。</p><hr><h3 id="⚠️-关键注意事项-windows-特别版" tabindex="-1">⚠️ 关键注意事项（Windows 特别版） <a class="header-anchor" href="#⚠️-关键注意事项-windows-特别版" aria-label="Permalink to &quot;⚠️ 关键注意事项（Windows 特别版）&quot;">​</a></h3><ol><li><p><strong>路径格式</strong><br><code>.pth</code> 文件必须使用 <strong>正斜杠 <code>/</code> 或双反斜杠 <code>\\\\</code></strong>，但 PowerShell 的 <code>echo</code> 会自动处理为单反斜杠（Windows 兼容），所以直接使用上述命令即可。</p></li><li><p><strong>Python 版本一致性</strong><br> 确保所有环境（shared-libs 和项目 .venv）使用<strong>完全相同的 Python 主版本</strong>（如都是 3.13.5）。建议：</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 在项目根目录统一指定 Python 解释器</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">py </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">-3.13</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">m venv shared</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">libs</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">py </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">-3.13</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">m venv .venv  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 在每个项目中执行</span></span></code></pre></div></li><li><p><strong>避免重复安装大库</strong><br> 在项目虚拟环境中<strong>绝对不要</strong>执行 <code>pip install langchain</code> 等命令，否则会覆盖共享库！</p></li><li><p><strong>更新共享库</strong><br> 当需要升级 langchain 等库时：</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">shared</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">libs\\Scripts\\activate</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pip install </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">upgrade langchain</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">deactivate</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 所有项目自动生效</span></span></code></pre></div></li></ol><hr><h3 id="📁-项目使用流程" tabindex="-1">📁 项目使用流程 <a class="header-anchor" href="#📁-项目使用流程" aria-label="Permalink to &quot;📁 项目使用流程&quot;">​</a></h3><ol><li>进入项目目录：<code>cd D:\\2024-code\\lesson2025\\14-16-LangChain-01</code></li><li>激活环境：<code>.venv\\Scripts\\activate</code></li><li>直接运行代码（自动访问共享库 + 项目专属小依赖）</li><li>退出：<code>deactivate</code></li></ol><hr><h3 id="本质理解" tabindex="-1">本质理解 <a class="header-anchor" href="#本质理解" aria-label="Permalink to &quot;本质理解&quot;">​</a></h3><blockquote><p>✅ <strong>每个子项目只需安装 <code>ipykernel</code> 并注册自己的 kernel；<br> JupyterLab 本身只在共享库环境中安装一次；<br> 启动 JupyterLab 时使用共享库环境，但 Notebook 可以选择任意子项目的 kernel 运行。</strong></p></blockquote><hr><h4 id="🧠-为什么这样设计是优雅的" tabindex="-1">🧠 为什么这样设计是优雅的？ <a class="header-anchor" href="#🧠-为什么这样设计是优雅的" aria-label="Permalink to &quot;🧠 为什么这样设计是优雅的？&quot;">​</a></h4><table tabindex="0"><thead><tr><th>角色</th><th>职责</th><th>安装位置</th></tr></thead><tbody><tr><td><strong>JupyterLab</strong></td><td>提供 Web UI、文件浏览器、终端等</td><td><code>shared-libs</code>（一次安装，全局使用）</td></tr><tr><td><strong>ipykernel</strong></td><td>让某个 Python 环境能被 Jupyter 调用</td><td>每个项目的 <code>.venv</code>（轻量，&lt;10 MB）</td></tr><tr><td><strong>项目依赖</strong></td><td>业务代码所需的库（如 langchain, torch）</td><td>共享大库 + 项目小依赖（通过 <code>.pth</code> 复用）</td></tr></tbody></table><p>这样：</p><ul><li><strong>不重复安装大库</strong> → 节省硬盘</li><li><strong>每个 Notebook 运行在正确的项目环境中</strong> → 隔离安全</li><li><strong>统一入口（一个 JupyterLab）</strong> → 使用方便</li></ul><hr><h4 id="🔁-工作流程回顾-日常使用" tabindex="-1">🔁 工作流程回顾（日常使用） <a class="header-anchor" href="#🔁-工作流程回顾-日常使用" aria-label="Permalink to &quot;🔁 工作流程回顾（日常使用）&quot;">​</a></h4><ol><li><p><strong>开发前</strong>（只需做一次/项目）：</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 在项目目录中</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.venv\\Scripts\\activate</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pip install ipykernel</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">python </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">m ipykernel install </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">my</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">project </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">display</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;My Project&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">deactivate</span></span></code></pre></div></li><li><p><strong>每天启动开发</strong>：</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cd D:\\</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2024</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">code\\lesson2025</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">shared</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">libs\\Scripts\\activate</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">jupyter lab</span></span></code></pre></div><p>→ 浏览器打开后，新建 Notebook 时选择对应项目的 kernel。</p></li><li><p><strong>运行代码时</strong>：</p><ul><li>Notebook 使用的是<strong>所选 kernel 对应的 <code>.venv</code> 环境</strong></li><li>自动能访问：项目小依赖 + 共享大库（因为 <code>.pth</code> 已配置）</li></ul></li></ol><hr><h4 id="💡-额外好处" tabindex="-1">💡 额外好处 <a class="header-anchor" href="#💡-额外好处" aria-label="Permalink to &quot;💡 额外好处&quot;">​</a></h4><ul><li><strong>切换环境无需重启 JupyterLab</strong>：直接在 Notebook 菜单里换 kernel。</li><li><strong>便于调试多个项目</strong>：一个窗口里可以同时打开 LangChain 和 SQL 项目的 Notebook。</li><li><strong>导出/分享 Notebook 时</strong>：只需说明“使用 <code>langchain-01</code> kernel”，别人按同样方式注册即可复现。</li></ul><hr><h4 id="⚠️-最后一个小提醒" tabindex="-1">⚠️ 最后一个小提醒 <a class="header-anchor" href="#⚠️-最后一个小提醒" aria-label="Permalink to &quot;⚠️ 最后一个小提醒&quot;">​</a></h4><p>确保你在注册 kernel 时，<strong>当前激活的是该项目的 <code>.venv</code></strong>，否则 kernel 会指向错误的 Python 环境。</p><p>你可以验证 kernel 是否正确：</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">jupyter kernelspec list</span></span></code></pre></div><p>输出应类似：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Available kernels:</span></span>
<span class="line"><span>  langchain-01      C:\\Users\\...\\AppData\\Roaming\\jupyter\\kernels\\langchain-01</span></span>
<span class="line"><span>  sql-langchain     C:\\Users\\...\\AppData\\Roaming\\jupyter\\kernels\\sql-langchain</span></span></code></pre></div><p>进入对应目录，查看 <code>kernel.json</code>，里面的 <code>argv</code> 应指向你项目 <code>.venv</code> 中的 <code>python.exe</code>。</p><h2 id="删除-jupyter-kernel" tabindex="-1">删除 jupyter kernel <a class="header-anchor" href="#删除-jupyter-kernel" aria-label="Permalink to &quot;删除 jupyter kernel&quot;">​</a></h2><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 列出 kernel 清单</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PS D:\\</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2024</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">code\\lesson202</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">5&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">jupyter kernelspec list</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Available kernels:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  1416</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">langchain</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    C:\\Users\\John\\AppData\\Roaming\\jupyter\\kernels\\</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1416</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">langchain</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">01</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">langchain</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    C:\\Users\\John\\AppData\\Roaming\\jupyter\\kernels\\case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">langchain</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">01</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">langchain__     C:\\Users\\John\\AppData\\Roaming\\jupyter\\kernels\\case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">langchain__</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  langchain</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">         C:\\Users\\John\\AppData\\Roaming\\jupyter\\kernels\\langchain</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">01</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  python3              C:\\Users\\John\\.pyenv\\pyenv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">win\\versions\\</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3.13</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">\\share\\jupyter\\kernels\\python3</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 删除一个 kernel</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PS D:\\</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2024</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">code\\lesson202</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">5&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jupyter kernelspec remove case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">langchain</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">01</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Kernel specs to remove:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">langchain</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     C:\\Users\\John\\AppData\\Roaming\\jupyter\\kernels\\case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">langchain</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">01</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Remove </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> kernel specs [</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">y/N</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]: y</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Removed C:\\Users\\John\\AppData\\Roaming\\jupyter\\kernels\\case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">langchain</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">01</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 列出 kernel 清单，验证删除是否成功</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PS D:\\</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2024</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">code\\lesson202</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">5&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> jupyter kernelspec list</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Available kernels:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  1416</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">langchain</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    C:\\Users\\John\\AppData\\Roaming\\jupyter\\kernels\\</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1416</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">langchain</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">01</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">langchain__     C:\\Users\\John\\AppData\\Roaming\\jupyter\\kernels\\case</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">langchain__</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  langchain</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">         C:\\Users\\John\\AppData\\Roaming\\jupyter\\kernels\\langchain</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">01</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  python3              C:\\Users\\John\\.pyenv\\pyenv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">win\\versions\\</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3.13</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">\\share\\jupyter\\kernels\\python3</span></span></code></pre></div>`,162)])])}const c=i(t,[["render",h]]);export{g as __pageData,c as default};
