---
title: PostgreSQL æ•°æ®åº“è®¾è®¡
description: è®°å½•åœ¨ PostgreSQL æ•°æ®åº“è®¾è®¡çš„è¿‡ç¨‹
date: 2025-12-27
tags: [PostgreSQL, æ•°æ®åº“è®¾è®¡]
---

## æµ‹è¯•åº“å’Œæ­£å¼åº“åˆ†ç¦»

> 2ä¸ªåå­—æ„ä¹‰æ˜ç¡®çš„æ•°æ®åº“ï¼Œä¸€ä¸ªç”¨äºæµ‹è¯•ï¼Œä¸€ä¸ªç”¨äºæ­£å¼ç¯å¢ƒã€‚è¿™æ˜¯ç¬¦åˆå·¥ç¨‹è§„èŒƒå’Œå®‰å…¨æœ€ä½³å®è·µçš„ã€‚

### é…å¥—å‘½åï¼ˆä¿æŒä¸€è‡´æ€§ï¼‰

| ç”¨æˆ·å | æ•°æ®åº“å | å¤‡æ³¨ |
| ------ | -------- | ------ |
| `kpfit_test` | `kpfit_test_db` | æµ‹è¯•ç¯å¢ƒ |
| `kpfit_prod` | `kpfit_prod_db` | æ­£å¼ç¯å¢ƒ |

---

### è¿™ä¸ªå‘½åæ–¹æ¡ˆçš„æ„ä¹‰

| ä¼˜ç‚¹ | è¯´æ˜ |
|------|------|
| **è¯­ä¹‰æ¸…æ™°** | ä¸€çœ‹å°±çŸ¥é“ `kpfit_test` æ˜¯æµ‹è¯•ç”¨ï¼Œ`kpfit_prod` æ˜¯æ­£å¼ç”¨ |
| **ä¸åº”ç”¨åç»‘å®š** | å‰ç¼€ `kpfit` è¡¨æ˜è¿™æ˜¯ä¸“å±äºä½ åº”ç”¨çš„æ•°æ®åº“è´¦å·ï¼Œé¿å…ä¸å…¶ä»–é¡¹ç›®æ··æ·† |
| **ç¯å¢ƒéš”ç¦»æ˜ç¡®** | å¼€å‘ã€æµ‹è¯•ã€éƒ¨ç½²æ—¶ä¸å®¹æ˜“è¿é”™åº“ï¼ˆæ¯”å¦‚ä¸ä¼šåœ¨ prod ç”¨æˆ·ä¸‹è·‘æµ‹è¯•è„šæœ¬ï¼‰ |
| **ä¾¿äºè‡ªåŠ¨åŒ–** | CI/CD è„šæœ¬ã€é…ç½®æ–‡ä»¶ï¼ˆå¦‚ `.env`ï¼‰å¯ä»¥æ˜ç¡®åŒºåˆ† `DB_USER_TEST` vs `DB_USER_PROD` |

---

### å®‰å…¨ä¸æƒé™

è™½ç„¶ PostgreSQL é»˜è®¤å·²éš”ç¦»ï¼ˆç”¨æˆ·åªèƒ½æ“ä½œè‡ªå·±æ‹¥æœ‰çš„æ•°æ®åº“ï¼‰ï¼Œä½†ä½ å¯ä»¥é¢å¤–åŠ å›ºï¼š

```sql
-- åˆ›å»ºæ­£å¼ç”¨æˆ·ï¼ˆå¼ºå¯†ç ï¼‰
CREATE USER kpfit_prod WITH PASSWORD 'YourStrong!ProdPassword2025';
CREATE DATABASE kpfit_prod_db OWNER kpfit_prod;

-- åˆ›å»ºæµ‹è¯•ç”¨æˆ·ï¼ˆå¯ç¨ç®€å•ï¼Œä½†åˆ«ç”¨ 123456ï¼‰
CREATE USER kpfit_test WITH PASSWORD 'KpFitTestPass';
CREATE DATABASE kpfit_test_db OWNER kpfit_test;
```

> âš ï¸ åˆ‡è®°ï¼š**æ­£å¼åº“å¯†ç ä¸è¦å’Œæµ‹è¯•åº“ç›¸åŒ**ï¼Œé¿å…å‡­æ®æ³„éœ²å¯¼è‡´ç”Ÿäº§äº‹æ•…ã€‚

---

### DBeaver è¿æ¥å‘½å

åœ¨ DBeaver ä¸­åˆ›å»ºä¸¤ä¸ªè¿æ¥ï¼Œå‘½åå¦‚ï¼š

+ `kpfit - PROD` â†’ è¿ `kpfit_prod_db` / ç”¨æˆ· `kpfit_prod`
+ `kpfit - TEST` â†’ è¿ `kpfit_test_db` / ç”¨æˆ· `kpfit_test`

è¿™æ ·åœ¨å·¦ä¾§å¯¼èˆªå™¨ä¸­ä¸€ç›®äº†ç„¶ï¼Œå¤§å¹…é™ä½è¯¯æ“ä½œé£é™©ã€‚

## postgres ç”¨æˆ·

> ä½ **ä¸éœ€è¦â€œåˆ›å»º `postgres` ç”¨æˆ·â€** â€”â€” å› ä¸º **`postgres` æ˜¯ PostgreSQL å®‰è£…æ—¶è‡ªåŠ¨åˆ›å»ºçš„è¶…çº§ç”¨æˆ·**ï¼Œå®ƒä¸€å®šå­˜åœ¨ï¼Œåªæ˜¯ä½ å¯èƒ½è¿˜æ²¡ç»™å®ƒè®¾ç½®å¯†ç ã€‚

---
### 2ä¸ª postgres ç”¨æˆ·

+ å®‰è£… PostgreSQLï¼ˆæ— è®ºæ˜¯ `apt install postgresql` è¿˜æ˜¯å…¶ä»–æ–¹å¼ï¼‰æ—¶ï¼Œç³»ç»Ÿä¼š**è‡ªåŠ¨åˆ›å»º**ï¼š
  + ä¸€ä¸ª**æ“ä½œç³»ç»Ÿç”¨æˆ·**ï¼š`postgres` - Linux ç³»ç»Ÿç”¨æˆ·ï¼ˆæ“ä½œç³»ç»Ÿå±‚é¢ï¼‰
  + ä¸€ä¸ª**æ•°æ®åº“ç”¨æˆ·ï¼ˆè§’è‰²ï¼‰**ï¼š`postgres` - PostgreSQL æ•°æ®åº“è§’è‰²ï¼ˆæ•°æ®åº“å†…éƒ¨å±‚é¢ï¼‰

---
### æ“ä½œç³»ç»Ÿç”¨æˆ·`postgres`

+ è¿™ä¸ª Linux ç³»ç»Ÿç”¨æˆ· postgres æ˜¯ä¸ªæ™®é€šç”¨æˆ·ï¼Œå®ƒå­˜åœ¨çš„æ ¸å¿ƒæ„ä¹‰æ˜¯ â€”â€” å®‰å…¨éš”ç¦»ï¼ˆSecurity Isolationï¼‰ã€‚
+ PostgreSQL æ•°æ®åº“æœåŠ¡å¿…é¡»ä»¥ä¸€ä¸ªé root çš„ä¸“ç”¨ç³»ç»Ÿç”¨æˆ·ï¼ˆpostgresï¼‰è¿è¡Œï¼Œè¿™æ˜¯æ“ä½œç³»ç»Ÿå®‰å…¨çš„åŸºæœ¬åŸåˆ™ã€‚

---
#### ç³»ç»Ÿç”¨æˆ·`postgres`çš„ä½œç”¨è¯¦è§£

| ä½œç”¨ | è¯´æ˜ |
|------|------|
| è¿›ç¨‹èº«ä»½ | PostgreSQL çš„ä¸»è¿›ç¨‹ (`postmaster`) å’Œå­è¿›ç¨‹éƒ½ä»¥ `postgres` ç”¨æˆ·èº«ä»½è¿è¡Œ |
| æ–‡ä»¶æ‰€æœ‰æƒ | æ‰€æœ‰æ•°æ®åº“æ•°æ®æ–‡ä»¶ï¼ˆåœ¨ `/var/lib/postgresql/...`ï¼‰éƒ½å±äº `postgres` ç”¨æˆ·ï¼Œå…¶ä»–ç”¨æˆ·æ— æ³•è¯»å†™ |
| æƒé™æœ€å°åŒ– | å³ä½¿æ•°æ®åº“è¢«æ”»ç ´ï¼Œæ”»å‡»è€…ä¹Ÿåªèƒ½åœ¨è¿™ä¸ªæ™®é€šç”¨æˆ·çš„æƒé™å†…æ´»åŠ¨ï¼ˆä¸èƒ½åˆ ç³»ç»Ÿæ–‡ä»¶ã€ä¸èƒ½æ”¹ç½‘ç»œé…ç½®ç­‰ï¼‰ |
| peer è®¤è¯ | Linux ç”¨æˆ· `deploy` æƒ³æ— å¯†ç ç™»å½•æ•°æ®åº“ï¼Ÿä¸è¡Œï¼ä½† `postgres` ç³»ç»Ÿç”¨æˆ·å¯ä»¥æ— å¯†ç ç™»å½• `postgres` æ•°æ®åº“è§’è‰² â€”â€” è¿™æ˜¯é€šè¿‡ **peer è®¤è¯** å®ç°çš„ï¼Œä¾èµ–ç³»ç»Ÿç”¨æˆ·èº«ä»½ |

---
#### ä¸ºä½•ä¸èƒ½ä½¿ç”¨ `deploy` æ¥æ“ä½œ

ç†è®ºä¸Šå¯ä»¥ï¼Œä½†**å¼ºçƒˆä¸å»ºè®®**ï¼ŒåŸå› ï¼š

1. **èŒè´£åˆ†ç¦»åŸåˆ™**ï¼šåº”ç”¨ç”¨æˆ·ï¼ˆ`deploy`ï¼‰â‰  æ•°æ®åº“ç”¨æˆ·ï¼ˆ`postgres`ï¼‰
2. **é¿å…æƒé™æ±¡æŸ“**ï¼šå¦‚æœ PostgreSQL ç”¨ `deploy` è¿è¡Œï¼Œä¸€æ—¦æ•°æ®åº“å´©æºƒï¼Œå¯èƒ½ä¼šå½±å“ä½ éƒ¨ç½²çš„å…¶ä»–ç¨‹åº
3. **å®‰å…¨å®¡è®¡å›°éš¾**ï¼šæ— æ³•åŒºåˆ†â€œæ˜¯ deploy ç”¨æˆ·æ“ä½œäº†ç³»ç»Ÿï¼Œè¿˜æ˜¯æ•°æ®åº“è¿›ç¨‹æ“ä½œäº†ç³»ç»Ÿâ€
4. **åŒ…ç®¡ç†å™¨ä¾èµ–**ï¼š`apt install postgresql` ä¼šè‡ªåŠ¨åˆ›å»º `postgres` ç”¨æˆ·ï¼Œå¹¶ç¡¬ç¼–ç åœ¨æœåŠ¡é…ç½®ä¸­

> ğŸ’¡ ç®€å•è¯´ï¼š**ä¸“ç”¨æœåŠ¡ â†’ ä¸“ç”¨ç”¨æˆ·**ï¼Œè¿™æ˜¯ Linux ä¸–ç•Œçš„é»„é‡‘æ³•åˆ™ã€‚

---
### æ•°æ®åº“ç”¨æˆ·`postgres`

+ è¿™ä¸ª `postgres` æ•°æ®åº“ç”¨æˆ·é»˜è®¤æ˜¯æ•°æ®åº“çš„**è¶…çº§ç”¨æˆ·ï¼ˆSUPERUSERï¼‰**ï¼Œæ‹¥æœ‰æ•°æ®åº“çš„æ‰€æœ‰æƒé™ã€‚
+ **é»˜è®¤æ²¡æœ‰è®¾ç½®å¯†ç **ï¼ˆå› ä¸ºæœ¬åœ°é€šè¿‡ `peer` è®¤è¯ï¼Œæ— éœ€å¯†ç å³å¯ç™»å½•ï¼‰ã€‚

---
#### è®¾ç½® postgres çš„å¯†ç 

> ç›®æ ‡ï¼šè®© `postgres` æ•°æ®åº“ç”¨æˆ·æœ‰å¯†ç ï¼Œä»¥ä¾¿åœ¨ DBeaver ä¸­ç”¨å®ƒæ‰§è¡Œç®¡ç†æ“ä½œï¼ˆå¦‚åˆ›å»º `kpfit_prod` ç­‰ç”¨æˆ·ï¼‰

+ æ­¥éª¤ï¼ˆåœ¨è…¾è®¯äº‘æœåŠ¡å™¨ä¸Šæ“ä½œï¼‰

```bash
# 1. åˆ‡æ¢åˆ° postgres ç³»ç»Ÿç”¨æˆ·ï¼ˆæ— éœ€å¯†ç ï¼Œåªè¦ä½ æœ‰ sudoï¼‰
deploy@VM-0-13-ubuntu:~$ sudo -u postgres psql
[sudo] password for deploy:
psql (16.11 (Ubuntu 16.11-0ubuntu0.24.04.1))
Type "help" for help.

postgres=#

# 2. åœ¨ psql ä¸­ä¸º postgres è§’è‰²è®¾ç½®å¯†ç 
# 3. æŒ‰æç¤ºè¾“å…¥ä¸€ä¸ªå¼ºå¯†ç ï¼ˆæ¯”å¦‚ YourPostgres!Admin2025ï¼‰
#    è¾“å…¥æ—¶ä¸ä¼šæ˜¾ç¤ºå­—ç¬¦ï¼Œè¾“å®Œå›è½¦å³å¯
postgres=# \password postgres
Enter new password for user "postgres":
Enter it again:
postgres=#

# 4. é€€å‡º
postgres=# \q
deploy@VM-0-13-ubuntu:~$
```

---
#### åœ¨ DBeaver ä¸­ä½¿ç”¨

+ ä½ å°±å¯ä»¥åœ¨ DBeaver ä¸­åˆ›å»ºä¸€ä¸ª**ç®¡ç†å‘˜è¿æ¥**ï¼š

+ Host: ä½ çš„å…¬ç½‘ IP  
+ Port: 5432  
+ Database: `postgres`ï¼ˆæˆ–ç•™ç©ºï¼‰  
+ Username: `postgres`  
+ Password: ä½ åˆšè®¾ç½®çš„å¯†ç   

ç”¨è¿™ä¸ªè¿æ¥å»æ‰§è¡Œï¼š

```sql
CREATE USER kpfit_prod ...;
CREATE DATABASE kpfit_prod_db ...;
-- ç­‰ç®¡ç†å‘½ä»¤
```

---
#### è¶…çº§ç”¨æˆ·ä¸æš´éœ²åœ¨è¿œç¨‹è¿æ¥ä¸­

ä½ **å®Œå…¨å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šç”¨ `sudo -u postgres psql` ç›´æ¥æ‰§è¡Œæ‰€æœ‰ç®¡ç†å‘½ä»¤**ï¼ˆå°±åƒä½ ä¹‹å‰åšçš„é‚£æ ·ï¼‰ï¼Œ**ä¸éœ€è¦ DBeaver è¿ `postgres`**ã€‚

ä¹Ÿå°±æ˜¯è¯´ï¼š

+ **æ—¥å¸¸å¼€å‘**ï¼šç”¨ `kpfit_test` / `kpfit_prod` è¿æ¥
+ **æ•°æ®åº“ç®¡ç†ï¼ˆå»ºç”¨æˆ·/åº“ï¼‰**ï¼šç›´æ¥åœ¨æœåŠ¡å™¨ç»ˆç«¯ç”¨ `sudo -u postgres psql` æ“ä½œ

> âœ… è¿™å…¶å®æ˜¯**æ›´å®‰å…¨çš„åšæ³•** â€”â€” è¶…çº§ç”¨æˆ·ä¸æš´éœ²åœ¨è¿œç¨‹è¿æ¥ä¸­ã€‚

---
## åˆ›å»ºæ•°æ®åº“

### postgres ç”¨æˆ·è¿æ¥æ•°æ®åº“æŠ¥é”™

+ DBeaver ä¸­ç”¨ `postgres` ç”¨æˆ·è¿æ¥æ•°æ®åº“æ—¶ï¼Œè¿æ¥æ•°æ®åº“æ—¶çš„æŠ¥é”™ï¼š

```bash
FATAL: no pg_hba.conf entry for host "124.79.8.217", user "postgres", database "postgres", SSL encryption
# è¿™ä¸ªé”™è¯¯éå¸¸å…¸å‹ï¼Œè¯´æ˜ PostgreSQL æ‹’ç»äº†ä½ ä»æœ¬åœ° IP 124.79.8.217 çš„è¿æ¥è¯·æ±‚.
# å› ä¸º pg_hba.conf ä¸­æ²¡æœ‰å…è®¸è¯¥ IP ç”¨ postgres ç”¨æˆ·è®¿é—®ã€‚
```

---
### è§£å†³ postgres æ— æ³•è¿œç¨‹è¿æ¥

#### ç¬¬ 1 æ­¥ï¼šç¡®è®¤ä½ çš„æœ¬åœ°å…¬ç½‘ IP

ä½ å·²ç»çŸ¥é“æ˜¯ `124.79.8.217`ï¼ˆä»é”™è¯¯ä¿¡æ¯ä¸­çœ‹å‡ºï¼‰ï¼Œä½†å»ºè®®å†æ¬¡ç¡®è®¤ï¼š

+ åœ¨æœ¬åœ°ç”µè„‘è®¿é—® [https://ip.cn](https://ip.cn) æˆ– [https://whatismyipaddress.com](https://whatismyipaddress.com)
+ ç¡®ä¿ IP æ²¡å˜ï¼ˆå®¶åº­å®½å¸¦ IP å¯èƒ½ä¼šå˜ï¼‰

#### ç¬¬ 2 æ­¥ï¼šç¼–è¾‘æœåŠ¡å™¨ä¸Šçš„ `pg_hba.conf`

ç™»å½•è…¾è®¯äº‘æœåŠ¡å™¨ï¼Œæ‰§è¡Œï¼š

```bash
sudo nano /etc/postgresql/*/main/pg_hba.conf
```

åœ¨æ–‡ä»¶**æœ«å°¾**æ·»åŠ ä¸€è¡Œï¼ˆå…è®¸ä½ çš„ IP ç”¨å¯†ç ç™»å½• `postgres` ç”¨æˆ·ï¼‰ï¼š

```ini
# å…è®¸ç‰¹å®š IP ä½¿ç”¨ postgres ç”¨æˆ·è¿œç¨‹ç™»å½•ï¼ˆä»…ç”¨äºç®¡ç†ï¼ï¼‰
host    postgres    postgres    124.79.8.217/32    md5
```

> ğŸ”’ **å®‰å…¨æé†’**ï¼š  
>
> + **ä¸è¦ç”¨ `0.0.0.0/0`**ï¼Œé™¤éä¸´æ—¶æµ‹è¯•ï¼ˆæµ‹è¯•å®Œç«‹åˆ»æ”¹å›ï¼‰  
> + `md5` è¡¨ç¤ºä½¿ç”¨å¯†ç è®¤è¯ï¼ˆä½ å·²ä¸º `postgres` è®¾ç½®å¯†ç ï¼‰

---

#### ç¬¬ 3 æ­¥ï¼šç¡®ä¿ `postgresql.conf` å…è®¸è¿œç¨‹è¿æ¥

æ£€æŸ¥ï¼š

```bash
sudo nano /etc/postgresql/*/main/postgresql.conf
```

ç¡®ä¿æœ‰ï¼š

```ini
listen_addresses = '*'
```

---

#### ç¬¬ 4 æ­¥ï¼šé‡å¯ PostgreSQL æœåŠ¡

```bash
sudo systemctl restart postgresql
```

---

#### ç¬¬ 5 æ­¥ï¼šDBeaver è¿æ¥é…ç½®

åœ¨ DBeaver ä¸­ï¼Œä½ çš„è¿æ¥åº”è®¾ç½®ä¸ºï¼š

| å­—æ®µ | å€¼ |
|------|----|
| Host | è…¾è®¯äº‘æœåŠ¡å™¨å…¬ç½‘ IP |
| Port | 5432 |
| Database | `postgres` |
| Username | `postgres` |
| Password | ä½ è®¾ç½®çš„ `postgres` å¯†ç  |
| SSL | **å»ºè®®è®¾ä¸º `disable` ä¸´æ—¶æµ‹è¯•**ï¼ˆæˆ–é€‰ `allow`ï¼‰|

> ğŸ’¡ å…³äº SSLï¼š  
> é”™è¯¯ä¿¡æ¯ä¸­æåˆ° `SSL encryption`ï¼Œè¯´æ˜ DBeaver é»˜è®¤å°è¯• SSL è¿æ¥ï¼Œä½†ä½ çš„ PG å¯èƒ½æœªé…ç½® SSLã€‚  
> **ä¸´æ—¶è§£å†³**ï¼šåœ¨ DBeaver è¿æ¥è®¾ç½® â†’ **ã€ŒSSLã€æ ‡ç­¾é¡µ â†’ å‹¾é€‰ â€œDisable SSLâ€**  
> ï¼ˆç”Ÿäº§ç¯å¢ƒå»ºè®®é… SSLï¼Œä½†ç°åœ¨å…ˆé€šå†è¯´ï¼‰

---

#### å®‰å…¨å»ºè®®ï¼ˆé‡è¦ï¼ï¼‰

+ **`postgres` è¶…çº§ç”¨æˆ·ä¸è¦é•¿æœŸå¼€æ”¾è¿œç¨‹è®¿é—®ï¼**
+ å»ºè®®ï¼š
  1. ç”¨ `postgres` è¿æ¥åˆ›å»ºå¥½ `kpfit_prod` / `kpfit_test` ç”¨æˆ·å’Œåº“
  2. **ç«‹å³ä» `pg_hba.conf` ä¸­åˆ é™¤ `postgres` çš„è¿œç¨‹è§„åˆ™**
  3. æ—¥å¸¸åªç”¨ `kpfit_*` ç”¨æˆ·è¿æ¥
+ æˆ–è€…è‡³å°‘ï¼š**åªå…è®¸ä½ çš„å›ºå®š IP è®¿é—®**

---

### æ›¿ä»£æ–¹æ¡ˆï¼ˆæ›´å®‰å…¨ï¼‰ï¼šä¸ç”¨è¿œç¨‹è¿ `postgres`

ä½ å…¶å®**ä¸éœ€è¦åœ¨ DBeaver ä¸­è¿ `postgres`**ï¼  
æ‰€æœ‰ç®¡ç†æ“ä½œéƒ½å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šç”¨ `sudo -u postgres psql` å®Œæˆï¼š

```bash
# åˆ›å»ºç”¨æˆ·å’Œåº“ï¼ˆåœ¨æœåŠ¡å™¨æ‰§è¡Œï¼‰
sudo -u postgres psql -c "
CREATE USER kpfit_prod WITH PASSWORD 'xxx';
CREATE DATABASE kpfit_prod_db OWNER kpfit_prod;
"
```

è¿™æ ·å°±**å®Œå…¨ä¸éœ€è¦å¼€æ”¾ `postgres` è¿œç¨‹æƒé™**ï¼Œæ›´å®‰å…¨ï¼

---

![DBeaver ä¸‹åˆ›å»ºæ•°æ®åº“](/assets/fullstack/set-up-on-tencent-cloud/create-db-for-user.png)

## è¿æ¥æ•°æ®åº“

### è¿æ¥è¢«æ‹’ç»

+ åœ¨ DBeaver ä¸­åˆ›å»ºä¸€ä¸ª**æµ‹è¯•è¿æ¥**ï¼ŒæŠ¥é”™ï¼š
  + FATAL: no pg_hba.conf entry for host "124.79.8.217", user "kpfit_test", database "kpfit_test_db", SSL encryption
+ PostgreSQL æœåŠ¡å™¨æ²¡æœ‰åœ¨ pg_hba.conf æ–‡ä»¶ä¸­é…ç½®å…è®¸æ¥è‡ª IP åœ°å€ 124.79.8.217 çš„è¿æ¥è¯·æ±‚ï¼ˆç‰¹åˆ«æ˜¯ä½¿ç”¨ç”¨æˆ· kpfit_test è®¿é—®æ•°æ®åº“ kpfit_test_dbg æ—¶ï¼‰ï¼Œè€Œä¸”å®¢æˆ·ç«¯è¦æ±‚ä½¿ç”¨ SSL åŠ å¯†è¿æ¥ã€‚

### æœåŠ¡å™¨ä¸Šä¿®æ”¹

+ åœ¨ PuTTY ä¸­ï¼Œä½¿ç”¨ `deploy` ç”¨æˆ·ç™»å½•æœåŠ¡å™¨ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œé‡å¯åç”Ÿæ•ˆ
  
```bash
# å€Ÿç”¨ postgres ç”¨æˆ·ï¼ŒæŸ¥çœ‹å½“å‰ PostgreSQL é…ç½®æ–‡ä»¶è·¯å¾„
deploy@VM-0-13-ubuntu:~$ sudo -u postgres psql -c 'SHOW hba_file;'

# ç¡®è®¤ deploy ç”¨æˆ·å¯†ç 
[sudo] password for deploy:

# åˆ—å‡ºå½“å‰ PostgreSQL é…ç½®æ–‡ä»¶è·¯å¾„
              hba_file
-------------------------------------
 /etc/postgresql/16/main/pg_hba.conf
(1 row)

# ç¼–è¾‘ pg_hba.conf æ–‡ä»¶ï¼Œæ·»åŠ å…è®¸ kpfit_test ç”¨æˆ·ä» 124.79.8.217 è¿æ¥
deploy@VM-0-13-ubuntu:~$ sudo nano /etc/postgresql/16/main/pg_hba.conf

# åœ¨é…ç½®æ–‡ä»¶çš„æœ«å°¾åŠ ä¸Šå¦‚ä¸‹å†…å®¹ï¼Œè¡¨ç¤ºå…è®¸ä»ä»»æ„IPè¿æ¥
# åº”ç”¨é…ç½®
host    kpfit_test_db   kpfit_test     0.0.0.0/0  scram-sha-256
host    kpfit_prod_db   kpfit_prod     0.0.0.0/0  scram-sha-256

# ä¿å­˜åé€€å‡º
# æŒ‰ Ctrl + O â†’ ä¿å­˜æ–‡ä»¶ï¼ˆä¼šæç¤ºç¡®è®¤æ–‡ä»¶åï¼Œç›´æ¥å›è½¦ï¼‰
# æŒ‰ Ctrl + X â†’ é€€å‡ºç¼–è¾‘å™¨

# é‡å¯ PostgreSQL æœåŠ¡
deploy@VM-0-13-ubuntu:~$ sudo systemctl restart postgresql@16-main
```
