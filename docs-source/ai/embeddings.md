---
title: Embeddings
description: åµŒå…¥
date: 2025-09-15
tags: [Embeddings, å‘é‡]
---

<BlogPost>

## ä½™å¼¦ç›¸ä¼¼åº¦

+ é€šè¿‡æµ‹é‡ä¸¤ä¸ªå‘é‡çš„`å¤¹è§’çš„ä½™å¼¦å€¼`æ¥åº¦é‡å®ƒä»¬ä¹‹é—´çš„`ç›¸ä¼¼æ€§`ã€‚
+ åˆ¤æ–­ä¸¤ä¸ªå‘é‡â¼¤è‡´æ–¹å‘æ˜¯å¦ç›¸åŒï¼Œ**æ–¹å‘ç›¸åŒæ—¶ï¼Œä½™å¼¦ç›¸ä¼¼åº¦ä¸º1**ï¼›ä¸¤ä¸ªå‘é‡**å¤¹è§’ä¸º90Â°æ—¶ï¼Œä½™å¼¦ç›¸ä¼¼åº¦çš„å€¼ä¸º0ï¼Œæ–¹å‘å®Œå…¨ç›¸åæ—¶ï¼Œä½™å¼¦ç›¸ä¼¼åº¦çš„å€¼ä¸º-1**ã€‚
+ ä¸¤ä¸ªå‘é‡ä¹‹é—´å¤¹è§’çš„ä½™å¼¦å€¼ä¸º[-1, 1]
+ ç»™å®šå±æ€§å‘é‡Aå’ŒBï¼ŒAå’ŒBä¹‹é—´çš„å¤¹è§’Î¸ä½™å¼¦å€¼å¯ä»¥é€šè¿‡ç‚¹ç§¯å’Œå‘é‡é•¿åº¦è®¡ç®—å¾—å‡º
  $$
  \cos \theta = \frac{A \cdot B}{||A|| \times ||B||}
  $$
  å…¶ä¸­ï¼Œ$A \cdot B$ è¡¨ç¤ºå‘é‡Aå’ŒBçš„ç‚¹ç§¯ï¼Œ$||A||$ å’Œ $||B||$ åˆ†åˆ«è¡¨ç¤ºå‘é‡Aå’ŒBçš„é•¿åº¦ã€‚

### ä½™å¼¦ç›¸ä¼¼åº¦è®¡ç®—ç¤ºä¾‹

#### ğŸ“˜ ä¸¤ä¸ªä¸‰ç»´å‘é‡çš„ä½™å¼¦ç›¸ä¼¼åº¦ï¼ˆCosine Similarityï¼‰è®¡ç®—å…¬å¼

è®¾æœ‰ä¸¤ä¸ªä¸‰ç»´å‘é‡ï¼š

$$
\mathbf{a} = \begin{pmatrix} a_1 \\ a_2 \\ a_3 \end{pmatrix}, \quad
\mathbf{b} = \begin{pmatrix} b_1 \\ b_2 \\ b_3 \end{pmatrix}
$$

å®ƒä»¬çš„**ä½™å¼¦ç›¸ä¼¼åº¦**å®šä¹‰ä¸ºï¼š

$$
\text{cosine\_similarity}(\mathbf{a}, \mathbf{b}) = \frac{\mathbf{a} \cdot \mathbf{b}}{\|\mathbf{a}\| \cdot \|\mathbf{b}\|}
= \frac{a_1 b_1 + a_2 b_2 + a_3 b_3}{\sqrt{a_1^2 + a_2^2 + a_3^2} \cdot \sqrt{b_1^2 + b_2^2 + b_3^2}}
$$

#### ğŸ“ è®¡ç®—æ­¥éª¤

1. **è®¡ç®—ç‚¹ç§¯ï¼ˆDot Productï¼‰**ï¼š
   $$
   \mathbf{a} \cdot \mathbf{b} = a_1 b_1 + a_2 b_2 + a_3 b_3
   $$

2. **è®¡ç®—å‘é‡ \(\mathbf{a}\) çš„æ¨¡ï¼ˆL2 èŒƒæ•°ï¼‰**ï¼š
   $$
   \|\mathbf{a}\| = \sqrt{a_1^2 + a_2^2 + a_3^2}
   $$

3. **è®¡ç®—å‘é‡ \(\mathbf{b}\) çš„æ¨¡**ï¼š
   $$
   \|\mathbf{b}\| = \sqrt{b_1^2 + b_2^2 + b_3^2}
   $$

4. **ä»£å…¥å…¬å¼è®¡ç®—ä½™å¼¦ç›¸ä¼¼åº¦**ï¼š
   $$
   \cos \theta = \frac{\mathbf{a} \cdot \mathbf{b}}{\|\mathbf{a}\| \cdot \|\mathbf{b}\|}
   $$

---

#### ğŸ“Œ ä¸¾ä¾‹è¯´æ˜

è®¾ï¼š

$$
\mathbf{a} = \begin{pmatrix} 2 \\ 3 \\ 1 \end{pmatrix}, \quad
\mathbf{b} = \begin{pmatrix} 1 \\ 2 \\ 2 \end{pmatrix}
$$

##### æ­¥éª¤ 1ï¼šç‚¹ç§¯

$$
\mathbf{a} \cdot \mathbf{b} = 2 \times 1 + 3 \times 2 + 1 \times 2 = 2 + 6 + 2 = 10
$$

##### æ­¥éª¤ 2ï¼šæ¨¡é•¿

$$
\|\mathbf{a}\| = \sqrt{2^2 + 3^2 + 1^2} = \sqrt{4 + 9 + 1} = \sqrt{14}
$$

$$
\|\mathbf{b}\| = \sqrt{1^2 + 2^2 + 2^2} = \sqrt{1 + 4 + 4} = \sqrt{9} = 3
$$

##### æ­¥éª¤ 3ï¼šä½™å¼¦ç›¸ä¼¼åº¦

$$
\cos \theta = \frac{10}{\sqrt{14} \times 3} = \frac{10}{3\sqrt{14}} \approx \frac{10}{11.225} \approx 0.891
$$

---

##### âœ… æœ€ç»ˆç»“æœ

$$
\boxed{\cos \theta \approx 0.891}
$$

> è¯´æ˜è¿™ä¸¤ä¸ªå‘é‡æ–¹å‘æ¯”è¾ƒæ¥è¿‘ï¼ˆå› ä¸ºæ¥è¿‘ 1ï¼‰ï¼Œå¤¹è§’çº¦ä¸º $\cos^{-1}(0.891) \approx 27^\circ$ã€‚

---

#### ğŸ’¡ å°è´´å£«ï¼ˆå¯é€‰è¡¥å……ï¼‰

+ ä½™å¼¦ç›¸ä¼¼åº¦èŒƒå›´ï¼š$-1 \leq \cos \theta \leq 1$
  + $\cos \theta = 1$ â†’ å®Œå…¨åŒå‘
  + $\cos \theta = 0$ â†’ æ­£äº¤ï¼ˆå‚ç›´ï¼‰
  + $\cos \theta = -1$ â†’ å®Œå…¨åå‘

+ ä½™å¼¦ç›¸ä¼¼åº¦**åªå…³å¿ƒæ–¹å‘ï¼Œä¸å…³å¿ƒå¤§å°**ï¼Œå› æ­¤å¸¸ç”¨äºæ–‡æœ¬ã€å›¾åƒç­‰ç‰¹å¾å‘é‡çš„ç›¸ä¼¼åº¦æ¯”è¾ƒã€‚

## Embedding model

**Embedding modelï¼ˆåµŒå…¥æ¨¡å‹ï¼‰** é€šå¸¸æ˜¯æŒ‡**å·²ç»è¿‡è®­ç»ƒçš„æ¨¡å‹**ï¼Œå®ƒçš„æ ¸å¿ƒåŠŸèƒ½æ˜¯ï¼š  
> **å°†ç¦»æ•£çš„ç¬¦å·**ï¼ˆå¦‚å•è¯ã€å¥å­ã€å›¾åƒã€ç”¨æˆ·IDç­‰ï¼‰ã€‚

å…·ä½“åˆ°**è¯åµŒå…¥**ï¼ˆword embeddingï¼‰åœºæ™¯ï¼Œè¿™ç±»æ¨¡å‹ï¼ˆå¦‚ Word2Vecã€GloVeã€FastTextï¼Œæˆ–ç°ä»£çš„ BERTã€Sentence-BERT ç­‰ï¼‰åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å­¦ä¹ åˆ°äº†è¯­è¨€çš„ç»Ÿè®¡è§„å¾‹å’Œè¯­ä¹‰ç»“æ„ï¼Œä½¿å¾—ï¼š

- è¯­ä¹‰æˆ–è¯­æ³•ä¸Šç›¸ä¼¼çš„è¯ï¼ˆå¦‚â€œçŒ«â€å’Œâ€œç‹—â€ã€â€œè·‘â€å’Œâ€œå¥”è·‘â€ï¼‰åœ¨å‘é‡ç©ºé—´ä¸­**è·ç¦»è¾ƒè¿‘**ï¼ˆä¾‹å¦‚ä½™å¼¦ç›¸ä¼¼åº¦é«˜ï¼‰ï¼›
- å‘é‡ä¹‹é—´çš„**å‡ ä½•å…³ç³»**èƒ½åæ˜ è¯­ä¹‰å…³ç³»ï¼ˆå¦‚ç±»æ¯”æ¨ç†ï¼šâ€œå·´é»â€ - â€œæ³•å›½â€ + â€œæ„å¤§åˆ©â€ â‰ˆ â€œç½—é©¬â€ï¼‰ã€‚

---

### è¡¥å……å‡ ç‚¹è¯´æ˜ï¼š

1. **â€œè®­ç»ƒå¥½â€æ˜¯å…³é”®**  
   æœªç»è®­ç»ƒçš„åµŒå…¥ï¼ˆæ¯”å¦‚éšæœºåˆå§‹åŒ–çš„å‘é‡ï¼‰æ²¡æœ‰è¯­ä¹‰ç»“æ„ã€‚åªæœ‰åœ¨å¤§é‡æ–‡æœ¬ä¸Šè®­ç»ƒåï¼Œæ¨¡å‹æ‰â€œå­¦ä¼šâ€æŠŠè¯­ä¹‰ç›¸è¿‘çš„è¯æ”¾å¾—è¿‘ã€‚

2. **åµŒå…¥å¯ä»¥æ˜¯é™æ€æˆ–åŠ¨æ€çš„**ï¼š
   - **é™æ€åµŒå…¥**ï¼ˆå¦‚ Word2Vecï¼‰ï¼šæ¯ä¸ªè¯å¯¹åº”ä¸€ä¸ªå›ºå®šå‘é‡ï¼Œä¸ç®¡ä¸Šä¸‹æ–‡å¦‚ä½•ã€‚
   - **åŠ¨æ€åµŒå…¥**ï¼ˆå¦‚ BERTï¼‰ï¼šåŒä¸€ä¸ªè¯åœ¨ä¸åŒå¥å­ä¸­ä¼šæœ‰ä¸åŒçš„å‘é‡è¡¨ç¤ºï¼Œæ›´èƒ½æ•æ‰ä¸Šä¸‹æ–‡è¯­ä¹‰ã€‚

3. **ä¸ä»…é™äºè¯**  
   Embedding æ¨¡å‹ä¹Ÿå¹¿æ³›ç”¨äºï¼š
   - å¥å­/æ®µè½ï¼ˆSentence-BERTï¼‰
   - å›¾åƒï¼ˆCLIP ä¸­çš„å›¾åƒåµŒå…¥ï¼‰
   - ç”¨æˆ·/å•†å“ï¼ˆæ¨èç³»ç»Ÿä¸­çš„ ID åµŒå…¥ï¼‰
   å®ƒä»¬çš„å…±åŒç›®æ ‡éƒ½æ˜¯ï¼š**åœ¨åŒä¸€ä¸ªå‘é‡ç©ºé—´ä¸­ï¼Œè®©è¯­ä¹‰æˆ–åŠŸèƒ½ç›¸ä¼¼çš„å¯¹è±¡è·ç¦»æ›´è¿‘**ã€‚

## word embedding

> é€šè¿‡Embeddingï¼ŒæŠŠåŸå…ˆè¯æ‰€åœ¨ç©ºé—´æ˜ å°„åˆ°ä¸€ä¸ªæ–°çš„ç©ºé—´ä¸­å»ï¼Œä½¿å¾—è¯­ä¹‰ä¸Šç›¸ä¼¼çš„å•è¯åœ¨è¯¥ç©ºé—´å†…è·ç¦»ç›¸è¿‘ã€‚

**è¯åµŒå…¥**ï¼ˆWord Embeddingï¼‰çš„æ ¸å¿ƒæ€æƒ³ï¼Œå…¶èƒŒåçš„åŸç†ä¸»è¦åŸºäº**åˆ†å¸ƒå‡è®¾**ï¼ˆDistributional Hypothesisï¼‰å’Œ**å‘é‡ç©ºé—´æ¨¡å‹**ï¼ˆVector Space Modelï¼‰ã€‚ä¸‹é¢ç®€è¦è§£é‡Šå…¶åŸç†ï¼š

---

### 1. **åˆ†å¸ƒå‡è®¾**ï¼ˆDistributional Hypothesisï¼‰
> â€œå…·æœ‰ç›¸ä¼¼ä¸Šä¸‹æ–‡çš„è¯ï¼Œè¯­ä¹‰ä¹Ÿç›¸ä¼¼ã€‚â€

è¿™æ˜¯è¯åµŒå…¥çš„ç†è®ºåŸºç¡€ã€‚ä¾‹å¦‚ï¼Œâ€œçŒ«â€å’Œâ€œç‹—â€ç»å¸¸å‡ºç°åœ¨ç›¸ä¼¼çš„ä¸Šä¸‹æ–‡ä¸­ï¼ˆå¦‚â€œå…»äº†ä¸€åª___â€ã€â€œ___åœ¨å«â€ï¼‰ï¼Œå› æ­¤å®ƒä»¬åœ¨è¯­ä¹‰ä¸Šè¢«è®¤ä¸ºæ˜¯ç›¸è¿‘çš„ã€‚

---

### 2. **ä»ç¦»æ•£åˆ°è¿ç»­ï¼šç¨ å¯†å‘é‡è¡¨ç¤º**
ä¼ ç»Ÿæ–¹æ³•ï¼ˆå¦‚ one-hot ç¼–ç ï¼‰å°†æ¯ä¸ªè¯è¡¨ç¤ºä¸ºé«˜ç»´ç¨€ç–å‘é‡ï¼ˆä¾‹å¦‚è¯è¡¨å¤§å°ä¸º 10,000ï¼Œåˆ™æ¯ä¸ªè¯æ˜¯ä¸€ä¸ª 10,000 ç»´å‘é‡ï¼Œåªæœ‰ä¸€ä¸ªä½ç½®ä¸º 1ï¼‰ã€‚è¿™ç§è¡¨ç¤ºï¼š
- æ— æ³•ä½“ç°è¯­ä¹‰ç›¸ä¼¼æ€§ï¼ˆä»»æ„ä¸¤ä¸ªè¯çš„å‘é‡æ­£äº¤ï¼Œè·ç¦»ç›¸åŒï¼‰ï¼›
- ç»´åº¦ç¾éš¾ï¼Œè®¡ç®—æ•ˆç‡ä½ã€‚

**è¯åµŒå…¥**å°†æ¯ä¸ªè¯æ˜ å°„ä¸ºä¸€ä¸ª**ä½ç»´ã€ç¨ å¯†çš„å®æ•°å‘é‡**ï¼ˆå¦‚ 128 ç»´ã€300 ç»´ï¼‰ï¼Œä½¿å¾—ï¼š
- è¯­ä¹‰ç›¸è¿‘çš„è¯ â†’ å‘é‡åœ¨ç©ºé—´ä¸­è·ç¦»è¿‘ï¼ˆå¦‚ä½™å¼¦ç›¸ä¼¼åº¦é«˜ï¼‰ï¼›
- å‘é‡ä¹‹é—´å¯è¿›è¡Œä»£æ•°è¿ç®—ï¼ˆå¦‚ â€œå›½ç‹ - ç”·äºº + å¥³äºº â‰ˆ å¥³ç‹â€ï¼‰ã€‚

---

### 3. **å¦‚ä½•å­¦ä¹ è¿™æ ·çš„æ˜ å°„**ï¼Ÿ
ä¸»æµæ–¹æ³•é€šè¿‡**é¢„æµ‹ä¸Šä¸‹æ–‡**æˆ–**é¢„æµ‹ç›®æ ‡è¯**æ¥è®­ç»ƒåµŒå…¥ï¼š

- **Skip-gram**ï¼ˆWord2Vecï¼‰ï¼šç»™å®šä¸€ä¸ªè¯ï¼Œé¢„æµ‹å…¶ä¸Šä¸‹æ–‡è¯ã€‚
- **CBOW**ï¼ˆContinuous Bag of Wordsï¼‰ï¼šç»™å®šä¸Šä¸‹æ–‡è¯ï¼Œé¢„æµ‹ä¸­å¿ƒè¯ã€‚
- **GloVe**ï¼šåŸºäºå…¨å±€è¯å…±ç°ç»Ÿè®¡çŸ©é˜µï¼Œæœ€å°åŒ–è¯å¯¹å…±ç°æ¦‚ç‡çš„å¯¹æ•°ä¸å‘é‡ç‚¹ç§¯ä¹‹é—´çš„è¯¯å·®ã€‚
- **Transformer-based embeddings**ï¼ˆå¦‚ BERTï¼‰ï¼šé€šè¿‡è‡ªæ³¨æ„åŠ›æœºåˆ¶åŠ¨æ€ç”Ÿæˆä¸Šä¸‹æ–‡ç›¸å…³çš„è¯å‘é‡ã€‚

è¿™äº›æ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œé€šè¿‡æ¢¯åº¦ä¸‹é™ä¸æ–­è°ƒæ•´è¯å‘é‡ï¼Œä½¿å¾—è¯­ä¹‰ç›¸ä¼¼çš„è¯åœ¨å‘é‡ç©ºé—´ä¸­é è¿‘ã€‚

---

### 4. **å‡ ä½•è§£é‡Š**
åœ¨åµŒå…¥ç©ºé—´ä¸­ï¼š
- è·ç¦»ï¼ˆå¦‚æ¬§æ°è·ç¦»ã€ä½™å¼¦è·ç¦»ï¼‰åæ˜ è¯­ä¹‰ç›¸ä¼¼åº¦ï¼›
- æ–¹å‘å¯èƒ½ç¼–ç è¯­ä¹‰å±æ€§ï¼ˆå¦‚æ€§åˆ«ã€æ—¶æ€ã€å¤§å°ç­‰ï¼‰ï¼›
- ç©ºé—´ç»“æ„å…·æœ‰ä¸€å®šçš„çº¿æ€§/éçº¿æ€§è§„å¾‹ã€‚

---

### æ€»ç»“
è¯åµŒå…¥çš„æœ¬è´¨æ˜¯ï¼š**é€šè¿‡æ•°æ®é©±åŠ¨çš„æ–¹å¼ï¼Œå°†ç¦»æ•£çš„ç¬¦å·ï¼ˆè¯ï¼‰æ˜ å°„åˆ°è¿ç»­çš„ä½ç»´å‘é‡ç©ºé—´ä¸­ï¼Œä½¿å¾—è¯¥ç©ºé—´çš„å‡ ä½•ç»“æ„èƒ½å¤Ÿåæ˜ è¯­ä¹‰å…³ç³»**ã€‚è¿™ä¾èµ–äºä¸Šä¸‹æ–‡åˆ†å¸ƒçš„ç»Ÿè®¡è§„å¾‹ï¼Œå¹¶é€šè¿‡ç¥ç»ç½‘ç»œæˆ–çŸ©é˜µåˆ†è§£ç­‰æ–¹æ³•å®ç°ã€‚

## Embedding model å®ç°ç›¸è¿‘è¯å‘é‡è·ç¦»çŸ­çš„åŸç†

> Embedding model èƒ½æŠŠæ„æ€æ¥è¿‘çš„è¯åˆ¤å®šä¸ºâ€œå‘é‡è·ç¦»è¿‘â€ï¼Œæœ¬è´¨ä¸Šæ˜¯é€šè¿‡â€œä¸Šä¸‹æ–‡ç›¸ä¼¼æ€§â€æ¥é—´æ¥å­¦ä¹ è¯­ä¹‰ç›¸ä¼¼æ€§ã€‚  

### ä¸€ã€ç†è®ºåŸºç¡€ï¼š**åˆ†å¸ƒå‡è®¾**ï¼ˆDistributional Hypothesisï¼‰

> â€œYou shall know a word by the company it keeps.â€  
> â€”â€” J.R. Firth (1957)

æ„æ€æ˜¯ï¼š**ä¸€ä¸ªè¯çš„å«ä¹‰ç”±å®ƒç»å¸¸å‡ºç°çš„ä¸Šä¸‹æ–‡å†³å®š**ã€‚  
- â€œçŒ«â€ å’Œ â€œç‹—â€ éƒ½å¸¸å‡ºç°åœ¨ â€œå…»äº†ä¸€åª___â€ã€â€œ___åœ¨å«â€ã€â€œå–œæ¬¢___â€ ç­‰ä¸Šä¸‹æ–‡ä¸­ï¼›
- è™½ç„¶å®ƒä»¬å­—é¢ä¸åŒï¼Œä½†â€œä¸Šä¸‹æ–‡åˆ†å¸ƒâ€é«˜åº¦ç›¸ä¼¼ â†’ æ¨¡å‹è®¤ä¸ºå®ƒä»¬è¯­ä¹‰ç›¸è¿‘ã€‚

å› æ­¤ï¼Œ**æ¨¡å‹ä¸éœ€è¦çŸ¥é“â€œçŒ«â€å’Œâ€œç‹—â€éƒ½æ˜¯åŠ¨ç‰©**ï¼Œåªéœ€è§‚å¯Ÿå®ƒä»¬â€œå‡ºç°åœ¨ç›¸ä¼¼çš„å¥å­ç¯å¢ƒé‡Œâ€ï¼Œå°±èƒ½æŠŠå®ƒä»¬æ˜ å°„åˆ°å‘é‡ç©ºé—´ä¸­é è¿‘çš„ä½ç½®ã€‚

---

### äºŒã€è®­ç»ƒæœºåˆ¶ï¼šé€šè¿‡é¢„æµ‹ä»»åŠ¡å­¦ä¹ ä¸Šä¸‹æ–‡å…³ç³»

ä¸»æµ embedding æ¨¡å‹é€šè¿‡ä»¥ä¸‹ä¸¤ç±»é¢„æµ‹ä»»åŠ¡æ¥è®­ç»ƒï¼š

#### 1. **Skip-gram**ï¼ˆWord2Vec çš„ä¸€ç§ï¼‰
- **ç›®æ ‡**ï¼šç»™å®šä¸€ä¸ªä¸­å¿ƒè¯ï¼ˆå¦‚ â€œappleâ€ï¼‰ï¼Œé¢„æµ‹å®ƒå‘¨å›´çš„ä¸Šä¸‹æ–‡è¯ï¼ˆå¦‚ â€œeatâ€, â€œredâ€, â€œfruitâ€ï¼‰ã€‚
- **è®­ç»ƒè¿‡ç¨‹**ï¼š
  - æ¨¡å‹ä¸ºæ¯ä¸ªè¯åˆ†é…ä¸€ä¸ªå¯å­¦ä¹ çš„å‘é‡ï¼›
  - é€šè¿‡ç¥ç»ç½‘ç»œï¼ˆæˆ–ç®€åŒ–ç‰ˆï¼‰è®¡ç®—ä¸­å¿ƒè¯å‘é‡ä¸ä¸Šä¸‹æ–‡è¯å‘é‡çš„ç›¸ä¼¼åº¦ï¼›
  - è°ƒæ•´å‘é‡ï¼Œä½¿å¾—çœŸå®ä¸Šä¸‹æ–‡è¯çš„æ¦‚ç‡é«˜ï¼Œéä¸Šä¸‹æ–‡è¯çš„æ¦‚ç‡ä½ï¼ˆç”¨ softmax + è´Ÿé‡‡æ ·ä¼˜åŒ–ï¼‰ã€‚
- **ç»“æœ**ï¼šç»å¸¸å‡ºç°åœ¨ç›¸åŒä¸Šä¸‹æ–‡ä¸­çš„è¯ï¼ˆå¦‚ â€œappleâ€ å’Œ â€œbananaâ€ï¼‰ä¼šè¢«æ‹‰è¿‘ã€‚

#### 2. **CBOW**ï¼ˆContinuous Bag of Wordsï¼‰
- **ç›®æ ‡**ï¼šç»™å®šä¸Šä¸‹æ–‡è¯ï¼ˆå¦‚ â€œeat red ___â€ï¼‰ï¼Œé¢„æµ‹ä¸­é—´çš„è¯ï¼ˆâ€œappleâ€ï¼‰ã€‚
- æ•ˆæœç±»ä¼¼ï¼Œåªæ˜¯æ–¹å‘ç›¸åã€‚

#### 3. **GloVe**ï¼ˆGlobal Vectorsï¼‰
- ä¸åŸºäºé¢„æµ‹ï¼Œè€Œæ˜¯ç»Ÿè®¡**å…¨å±€è¯å…±ç°çŸ©é˜µ**ï¼›
- å¦‚æœä¸¤ä¸ªè¯ç»å¸¸å’Œç›¸åŒçš„å…¶ä»–è¯ä¸€èµ·å‡ºç°ï¼ˆå…±ç°æ¨¡å¼ç›¸ä¼¼ï¼‰ï¼Œå®ƒä»¬çš„å‘é‡å°±ä¼šæ¥è¿‘ï¼›
- é€šè¿‡çŸ©é˜µåˆ†è§£æ€æƒ³ï¼Œæœ€å°åŒ–ï¼š  
  \( (\mathbf{w}_i^\top \mathbf{w}_j - \log X_{ij})^2 \)  
  å…¶ä¸­ \(X_{ij}\) æ˜¯è¯ i å’Œ j çš„å…±ç°æ¬¡æ•°ã€‚

#### 4. **ç°ä»£ä¸Šä¸‹æ–‡æ¨¡å‹**ï¼ˆå¦‚ BERTï¼‰
- ä½¿ç”¨ Transformerï¼Œé€šè¿‡**æ©ç è¯­è¨€å»ºæ¨¡**ï¼ˆMasked Language Modelï¼‰ï¼š
  - è¾“å…¥å¥å­å¦‚ â€œI eat [MASK] every morningâ€ï¼Œæ¨¡å‹é¢„æµ‹ â€œ[MASK]â€ æ˜¯ â€œappleâ€ã€â€œbananaâ€ ç­‰ï¼›
  - åœ¨å¤§é‡æ–‡æœ¬ä¸Šè®­ç»ƒåï¼Œæ¨¡å‹å­¦åˆ°ï¼šåœ¨â€œåƒâ€çš„è¯­å¢ƒä¸‹ï¼Œæ°´æœç±»è¯æ˜¯å¯äº’æ¢çš„ï¼›
  - å› æ­¤ â€œappleâ€ å’Œ â€œbananaâ€ åœ¨è¯¥ä¸Šä¸‹æ–‡ä¸‹çš„è¡¨ç¤ºä¼šå¾ˆæ¥è¿‘ã€‚

---

### ä¸‰ã€ä¸ºä»€ä¹ˆè¿™æ ·èƒ½å­¦åˆ°â€œè¯­ä¹‰æ¥è¿‘â€ï¼Ÿ

å› ä¸º**è¯­è¨€ä½¿ç”¨ä¸­ï¼Œè¯­ä¹‰ç›¸è¿‘çš„è¯å¾€å¾€å¯ä»¥äº’æ¢è€Œä¸ç ´åå¥å­åˆç†æ€§**ã€‚  
æ¨¡å‹é€šè¿‡å¤§é‡æ–‡æœ¬è§‚å¯Ÿåˆ°è¿™ç§â€œå¯æ›¿æ¢æ€§â€æˆ–â€œå…±ç°æ¨¡å¼ç›¸ä¼¼æ€§â€ï¼Œä»è€Œåœ¨å‘é‡ç©ºé—´ä¸­å°†å®ƒä»¬èšé›†åœ¨ä¸€èµ·ã€‚

> ä¸¾ä¾‹ï¼š  
> - â€œåŒ»ç”Ÿâ€ å’Œ â€œæŠ¤å£«â€ éƒ½å¸¸ä¸ â€œåŒ»é™¢â€ã€â€œç—…äººâ€ã€â€œæ²»ç–—â€ å…±ç°ï¼›  
> - â€œè·‘â€ å’Œ â€œè·³â€ éƒ½å¸¸ä¸ â€œè¿åŠ¨â€ã€â€œå¿«â€ã€â€œè…¿â€ å…±ç°ï¼›  
> â†’ æ¨¡å‹è‡ªåŠ¨å°†å®ƒä»¬åˆ†åˆ«èšç±»ã€‚

---

### å››ã€å…³é”®ç‚¹æ€»ç»“

| é—®é¢˜ | å›ç­” |
|------|------|
| **æ¨¡å‹çŸ¥é“â€œæ„æ€â€å—**ï¼Ÿ | ä¸çŸ¥é“ã€‚å®ƒåªçœ‹åˆ°ç»Ÿè®¡è§„å¾‹ï¼ˆä¸Šä¸‹æ–‡ï¼‰ï¼Œä¸ç†è§£äººç±»è¯­ä¹‰ã€‚ |
| **æ€ä¹ˆå®šä¹‰â€œæ¥è¿‘â€**ï¼Ÿ | é€šè¿‡å‘é‡è·ç¦»ï¼ˆå¦‚ä½™å¼¦ç›¸ä¼¼åº¦ï¼‰è¡¡é‡ï¼›è®­ç»ƒç›®æ ‡éšå¼ä¼˜åŒ–è¿™ä¸€ç‚¹ã€‚ |
| **éœ€è¦æ ‡æ³¨æ•°æ®å—**ï¼Ÿ | ä¸éœ€è¦ï¼ç»å¤§å¤šæ•° embedding æ¨¡å‹æ˜¯**è‡ªç›‘ç£**æˆ–**æ— ç›‘ç£**çš„ï¼Œä»…éœ€åŸå§‹æ–‡æœ¬ã€‚ |
| **ä¸ºä»€ä¹ˆæœ‰æ•ˆ**ï¼Ÿ | å› ä¸ºè‡ªç„¶è¯­è¨€ä¸­ï¼Œè¯­ä¹‰ç›¸ä¼¼ â†” ä¸Šä¸‹æ–‡åˆ†å¸ƒç›¸ä¼¼ï¼Œè¿™æ˜¯è¯­è¨€çš„å†…åœ¨è§„å¾‹ã€‚ |

---

## Embedding model çš„ç†è§£

### ä»å¤´ç”¨é¢†åŸŸè¯­æ–™è®­ç»ƒå°æ¨¡å‹

+ ä»¥ä¸‹ä»£ç ä¸­çš„ model2 å°±æ˜¯æˆ‘ä»¬è®­ç»ƒçš„å°æ¨¡å‹ï¼Œå®ƒçš„å‚æ•° vector_size=128 è¡¨ç¤ºæ¯ä¸ªè¯çš„å‘é‡ç»´åº¦æ˜¯ 128ã€‚

```python
# å¦‚æœç›®å½•ä¸­æœ‰å¤šä¸ªæ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨PathLineSentences
segment_folder = './journey_to_the_west/segment'
# åˆ‡åˆ†ä¹‹åçš„å¥å­åˆé›†
sentences = word2vec.PathLineSentences(segment_folder)

# è®¾ç½®æ¨¡å‹å‚æ•°ï¼Œè¿›è¡Œè®­ç»ƒ
model = word2vec.Word2Vec(sentences, vector_size=100, window=3, min_count=1)
#print(model.wv['å­™æ‚Ÿç©º'])
print(model.wv.similarity('å­™æ‚Ÿç©º', 'çŒªå…«æˆ’'))
print(model.wv.similarity('å­™æ‚Ÿç©º', 'å­™è¡Œè€…'))
print(model.wv.most_similar(positive=['å­™æ‚Ÿç©º', 'å”åƒ§'], negative=['å­™è¡Œè€…']))
# è®¾ç½®æ¨¡å‹å‚æ•°ï¼Œè¿›è¡Œè®­ç»ƒ
model2 = word2vec.Word2Vec(sentences, vector_size=128, window=5, min_count=5, workers=multiprocessing.cpu_count())
# ä¿å­˜æ¨¡å‹
model2.save('./models/word2Vec.model')
print(model2.wv.similarity('å­™æ‚Ÿç©º', 'çŒªå…«æˆ’'))
print(model2.wv.similarity('å­™æ‚Ÿç©º', 'å­™è¡Œè€…'))
print(model2.wv.most_similar(positive=['å­™æ‚Ÿç©º', 'å”åƒ§'], negative=['å­™è¡Œè€…']))
```

### ç½‘ä¸Šä¸‹è½½çš„çŸ¥åè¯å‘é‡æ¨¡å‹

+ å¦‚ Google News Word2Vecã€GloVeã€FastTextã€ä¸­æ–‡çš„ word2vec-æ–°é—»ã€BERT çš„ embedding ç­‰
+ ç»è¿‡æµ·é‡æ•°æ®è®­ç»ƒè¿‡
+ å¼€ç®±å³ç”¨
+ å¯å¾®è°ƒæˆ–ç»§ç»­è®­ç»ƒ

### Embedding model å’Œ LLM çš„å¯¹æ¯”

ä»å‡ ä¸ªç»´åº¦æ›´ç³»ç»Ÿåœ°å¯¹æ¯” **Embedding æ¨¡å‹**ï¼ˆå¦‚ Word2Vecã€Sentence-BERT ç­‰ï¼‰å’Œ **å¤§è¯­è¨€æ¨¡å‹**ï¼ˆLLMï¼Œå¦‚ GPTã€LLaMAã€Qwen ç­‰ï¼‰ï¼š

---

### âœ… 1. **è®­ç»ƒæ–¹å¼ï¼šæ— ç›‘ç£ vs è‡ªç›‘ç£ï¼ˆå¹¿ä¹‰æ— ç›‘ç£ï¼‰**
- **Embedding æ¨¡å‹**ï¼ˆå¦‚ Word2Vecã€GloVeï¼‰ï¼š
  - ä½¿ç”¨**çº¯æ— ç›‘ç£å­¦ä¹ **ï¼Œä»…ä¾èµ–åŸå§‹æ–‡æœ¬çš„è¯åºæˆ–å…±ç°ç»Ÿè®¡ã€‚
  - ä¾‹å¦‚ Word2Vec çš„ Skip-gramï¼šé¢„æµ‹ä¸Šä¸‹æ–‡è¯ â†’ ä¸éœ€è¦äººå·¥æ ‡æ³¨ã€‚
- **å¤§è¯­è¨€æ¨¡å‹**ï¼ˆLLMï¼‰ï¼š
  - ä½¿ç”¨**è‡ªç›‘ç£å­¦ä¹ **ï¼ˆä¸€ç§æ— ç›‘ç£çš„å­ç±»ï¼‰ï¼Œå…¸å‹ä»»åŠ¡æ˜¯â€œè¯­è¨€å»ºæ¨¡â€ï¼ˆå¦‚é¢„æµ‹ä¸‹ä¸€ä¸ªè¯ï¼‰ã€‚
  - è™½ç„¶ä¹Ÿä¸éœ€è¦äººå·¥æ ‡ç­¾ï¼Œä½†ç›®æ ‡æ›´å¤æ‚ï¼Œæ¨¡å‹ç»“æ„æ›´å¤§ã€‚

> ğŸ“Œ æ‰€ä»¥ä¸¤è€…éƒ½ä¸éœ€è¦æ ‡æ³¨æ•°æ®ï¼Œä½† LLM çš„è®­ç»ƒç›®æ ‡æ›´â€œé€šç”¨â€å’Œâ€œç”Ÿæˆå¼â€ã€‚

---

### âœ… 2. **è®­ç»ƒæˆæœ¬ï¼šEmbedding æ¨¡å‹è¿œä½äº LLM**
| é¡¹ç›® | Embedding æ¨¡å‹ï¼ˆå¦‚ Word2Vecï¼‰ | å¤§è¯­è¨€æ¨¡å‹ï¼ˆå¦‚ LLaMA-7Bï¼‰ |
|------|-------------------------------|---------------------------|
| å‚æ•°é‡ | å‡ åä¸‡ ~ å‡ ç™¾ä¸‡ | æ•°åäº¿ ~ æ•°ä¸‡äº¿ |
| è®­ç»ƒæ•°æ® | ç™¾ä¸‡~åäº¿è¯ | æ•°ä¸‡äº¿ token |
| ç¡¬ä»¶éœ€æ±‚ | å•æœº CPU/GPUï¼Œå‡ å°æ—¶ | æ•°ç™¾~æ•°åƒ GPUï¼Œæ•°å‘¨~æ•°æœˆ |
| èƒ½è€—/è´¹ç”¨ | å‡ å…ƒ ~ å‡ ç™¾å…ƒ | æ•°ç™¾ä¸‡ç¾å…ƒ |

ğŸ‘‰ **ç»“è®º**ï¼šEmbedding æ¨¡å‹è®­ç»ƒç¡®å®â€œå»‰ä»·å¾—å¤šâ€ã€‚

---

### âœ… 3. **æ¨ç†/æŸ¥è¯¢é€Ÿåº¦ï¼šEmbedding æ¨¡å‹å¿«å¾—å¤š**
- **Embedding æ¨¡å‹**ï¼š
  - è¯å‘é‡æ˜¯**é™æ€æŸ¥è¡¨**ï¼ˆlookup + å¯é€‰ç®€å•è®¡ç®—ï¼‰ã€‚
  - ä¾‹å¦‚ `model.wv['å­™æ‚Ÿç©º']` æ˜¯ O(1) çš„å“ˆå¸ŒæŸ¥æ‰¾ã€‚
  - ç›¸ä¼¼åº¦è®¡ç®—ï¼ˆå¦‚ä½™å¼¦ç›¸ä¼¼åº¦ï¼‰ä¹Ÿæå¿«ã€‚
- **å¤§è¯­è¨€æ¨¡å‹**ï¼š
  - æ¯æ¬¡ç”Ÿæˆæˆ– embedding æå–éƒ½éœ€è¦**å®Œæ•´å‰å‘ä¼ æ’­**ï¼ˆthrough deep transformer layersï¼‰ã€‚
  - å³ä½¿åªå–æœ€åä¸€å±‚ hidden state ä½œ embeddingï¼Œä¹Ÿæ¯” Word2Vec æ…¢å‡ å~å‡ ç™¾å€ã€‚

> ğŸ“Œ åœ¨é«˜å¹¶å‘ã€ä½å»¶è¿Ÿåœºæ™¯ï¼ˆå¦‚æœç´¢å¼•æ“ã€æ¨èç³»ç»Ÿï¼‰ï¼Œ**é™æ€ embedding ä»æ˜¯é¦–é€‰**ã€‚

---

### âš ï¸ ä½†è¦æ³¨æ„ï¼šä¸æ˜¯æ‰€æœ‰ â€œembedding modelâ€ éƒ½ä¾¿å®œï¼

- **ä¼ ç»Ÿè¯å‘é‡**ï¼ˆWord2Vecã€GloVeï¼‰ï¼šâœ… ä¾¿å®œã€å¿«ã€é™æ€ã€‚
- **ä¸Šä¸‹æ–‡æ„ŸçŸ¥ embedding æ¨¡å‹**ï¼ˆå¦‚ BERTã€Sentence-BERTï¼‰ï¼š
  - è™½ç„¶ä¹Ÿè¾“å‡º embeddingï¼Œä½†**æ¯æ¬¡è¾“å…¥éƒ½è¦è¿‡ç¥ç»ç½‘ç»œ**ã€‚
  - è®­ç»ƒå’Œæ¨ç†æˆæœ¬è¿œé«˜äº Word2Vecï¼Œæ¥è¿‘å°å‹ LLMã€‚
  - ä½†æ¯” GPT-4 è¿™ç±» LLM ä»ä¾¿å®œå¾ˆå¤šã€‚

> æ‰€ä»¥ä¸¥æ ¼æ¥è¯´ï¼š**â€œç»å…¸ embedding æ¨¡å‹â€ â‰ª â€œä¸Šä¸‹æ–‡ embedding æ¨¡å‹â€ < â€œå¤§è¯­è¨€æ¨¡å‹â€**ï¼ˆåœ¨æˆæœ¬å’Œé€Ÿåº¦ä¸Šï¼‰ã€‚

---

### âœ… 4. **èƒ½åŠ›å¯¹æ¯”**
| èƒ½åŠ› | Word2Vec ç±» | BERT/SBERT ç±» | å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰ |
|------|-------------|---------------|------------------|
| è¯ä¹‰è¡¨ç¤º | âœ…ï¼ˆé™æ€ï¼‰ | âœ…âœ…ï¼ˆä¸Šä¸‹æ–‡åŠ¨æ€ï¼‰ | âœ…âœ…âœ…ï¼ˆæå¼ºä¸Šä¸‹æ–‡ï¼‰ |
| å¤„ç†ä¸€è¯å¤šä¹‰ | âŒï¼ˆâ€œè‹¹æœâ€å…¬å¸ vs æ°´æœä¸€æ ·ï¼‰ | âœ…ï¼ˆæ ¹æ®å¥å­åŒºåˆ†ï¼‰ | âœ…âœ…âœ… |
| ç”Ÿæˆæ–‡æœ¬ | âŒ | âŒï¼ˆä»…ç¼–ç ï¼‰ | âœ…âœ…âœ… |
| åšæ¨ç†/é—®ç­” | âŒ | æœ‰é™ï¼ˆéœ€é…åˆå…¶ä»–æ¨¡å—ï¼‰ | âœ…ï¼ˆç«¯åˆ°ç«¯ï¼‰ |
| å¿«é€Ÿç›¸ä¼¼åº¦æ£€ç´¢ | âœ…âœ…âœ… | âœ…ï¼ˆè¾ƒæ…¢ï¼‰ | âš ï¸ï¼ˆæ…¢ä¸”è´µï¼‰ |

---

### ğŸ’¡ å®é™…å»ºè®®ï¼š
- å¦‚æœä½ åªéœ€è¦**è¯/å¥ç›¸ä¼¼åº¦ã€èšç±»ã€å¬å›** â†’ ç”¨ **Sentence-BERT** æˆ– **è®­ç»ƒé¢†åŸŸ Word2Vec**ã€‚
- å¦‚æœä½ éœ€è¦**ç”Ÿæˆã€æ¨ç†ã€å¯¹è¯** â†’ ç”¨ **LLM**ã€‚
- å¾ˆå¤šç³»ç»Ÿ**ä¸¤è€…ç»“åˆ**ï¼šç”¨ embedding å¿«é€Ÿå¬å›å€™é€‰ï¼Œå†ç”¨ LLM ç²¾æ’æˆ–ç”Ÿæˆã€‚

ä½ ç°åœ¨çš„åšæ³•ï¼ˆç”¨ã€Šè¥¿æ¸¸è®°ã€‹è®­ç»ƒ Word2Vecï¼‰æ­£æ˜¯**ä½æˆæœ¬ã€é«˜æ•ˆç‡è§£å†³ç‰¹å®šé¢†åŸŸè¯­ä¹‰é—®é¢˜**çš„å…¸å‹èŒƒä¾‹ï¼

</BlogPost>
